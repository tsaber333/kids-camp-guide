<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Foursquare Kids Camp - Interactive Leader's Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .chart-container { position: relative; width: 100%; max-width: 350px; margin-left: auto; margin-right: auto; height: 350px; }
        .modal { display: none; }
        .modal.active { display: flex; }
        .card-enter {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.3s ease-out, transform 0.3s ease-out;
        }
        .card-enter-active {
            opacity: 1;
            transform: translateY(0);
        }
        /* Custom scrollbar for modals */
        .modal-content-scroll::-webkit-scrollbar {
            width: 8px;
        }
        .modal-content-scroll::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        .modal-content-scroll::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        .modal-content-scroll::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        /* Collapsible section styles */
        .collapsible-content {
            max-height: 1000px; /* Arbitrarily large value */
            overflow: hidden;
            transition: max-height 0.5s ease-out, opacity 0.5s ease-out;
            opacity: 1;
        }
        .collapsible-content.collapsed {
            max-height: 0;
            opacity: 0;
        }
        .collapse-icon {
            transition: transform 0.3s ease-out;
        }
        .collapse-icon.collapsed {
            transform: rotate(-90deg);
        }
    </style>
</head>
<body class="bg-stone-50 text-stone-800">

    <div id="app-container" class="max-w-7xl mx-auto p-4 sm:p-6 lg:p-8">
        
        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-teal-700">Foursquare Kids Camp</h1>
            <p class="mt-4 text-lg text-stone-600">Interactive Leader's Guide</p>
            <div id="user-id-display" class="mt-2 text-sm text-stone-500"></div>
        </header>

        <main>
            <section id="dashboard" class="mb-12">
                 <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 items-center">
                    <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                        <h2 class="text-2xl font-bold text-teal-700 mb-2">Welcome, Camp Leaders!</h2>
                        <p class="text-stone-600">
                            This guide is your central hub for planning and leading activities. Use the filters below to quickly find the perfect game for your next slot, whether you're on the field or need an indoor option for a rainy day. Each game card provides a full breakdown of instructions, materials, and key discussion points to connect with our camp's mission.
                        </p>
                        <button id="view-deleted-activities-btn" class="mt-4 bg-red-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-red-600 transition-colors text-sm">
                            View Deleted Activities (<span id="deleted-count">0</span>)
                        </button>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                        <h3 class="text-xl font-bold text-center text-teal-700 mb-4">Activity Overview</h3>
                        <div class="chart-container" style="height: 150px; max-width: 150px;">
                            <canvas id="activityTypeChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <section id="leader-resources" class="mb-12 bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                <div class="flex justify-between items-center cursor-pointer" id="leader-resources-toggle">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4">Leader Resources & Best Practices</h2>
                    <button class="text-stone-500 hover:text-teal-600 transition-colors">
                        <span class="text-2xl font-bold collapse-icon">&#9660;</span> <!-- Down arrow -->
                    </button>
                </div>
                <div id="leader-resources-content" class="collapsible-content">
                    <p class="text-stone-600 mb-4">
                        This section provides essential guidance to help you make the most of this interactive guide and ensure a successful, safe, and spiritually impactful activity time for your campers.
                    </p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <h3 class="text-xl font-bold text-teal-700 mb-2">Navigating This Guide</h3>
                            <ul class="list-disc list-inside text-stone-700 space-y-2">
                                <li><strong>Filtering Activities:</strong> Use the "Filter by Type," "Filter by Location," and "Filter by Materials" to quickly narrow down game options. Select "All" to see the full list again.</li>
                                <li><strong>Viewing Details:</strong> Click on any activity card to open a detailed modal. This modal contains objectives, step-by-step instructions, a comprehensive materials list, crucial safety notes, and the "SuperCharged Application."</li>
                                <li><strong>Material Check:</strong> Always review the "Materials Needed" section well in advance of your activity time to ensure all supplies are readily available.</li>
                            </ul>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-teal-700 mb-2">Leading Activities Effectively</h3>
                            <ul class="list-disc list-inside text-stone-700 space-y-2">
                                <li><strong>Safety First:</strong> Prioritize the "Safety Notes" for each game. Conduct a quick safety check of the play area and equipment before starting.</li>
                                <li><strong>Clear Instructions:</strong> Explain game rules clearly and concisely. Demonstrate if possible. Encourage questions before starting.</li>
                                <li><strong>Adapt & Modify:</strong> Feel free to adapt games to suit your group's size, age, energy levels, or available space.</li>
                                <li><strong>Encourage Participation:</strong> Create an inclusive environment where every camper feels comfortable participating and trying their best.</li>
                                <li><strong>Time Management:</strong> Keep an eye on the clock to ensure you have enough time for the activity itself and, crucially, for the debriefing.</li>
                            </ul>
                        </div>
                        <div class="md:col-span-2">
                            <h3 class="text-xl font-bold text-teal-700 mb-2">Maximizing the "SuperCharged Application"</h3>
                            <p class="text-stone-700">
                                The "SuperCharged Application" is key to connecting our activities with the spiritual growth of our campers. This section provides prompts and ideas to help you facilitate meaningful discussions after each game.
                            </p>
                            <ul class="list-disc list-inside text-stone-700 space-y-2 mt-2">
                                <li><strong>Purpose:</strong> This is where we bridge the fun of the game to life lessons and Foursquare values.</li>
                                <li><strong>Timing:</strong> Always debrief immediately after the game, while the experience is fresh in their minds.</li>
                                <li><strong>Open-Ended Questions:</strong> Use the suggested questions as a starting point. Encourage honest sharing and active listening among campers.</li>
                                <li><strong>Connect to Scripture/Values:</strong> Help campers see how the game's lessons relate to Bible principles or the Foursquare values (e.g., 'Jesus the Savior, Healer, Baptizer with the Holy Spirit, and Soon-Coming King').</li>
                                <li><strong>Personal Reflection:</strong> Encourage campers to think about how they can apply these lessons in their daily lives.</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="activity-finder">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-200 mb-8">
                    <h2 class="text-2xl font-bold text-teal-700 mb-4">Find an Activity</h2>
                    <div class="flex flex-wrap gap-4 items-center">
                        <div>
                            <label class="font-bold text-stone-700">Filter by Type:</label>
                            <div id="type-filters" class="flex flex-wrap gap-2 mt-2">
                                <button class="filter-btn-type bg-teal-600 text-white py-2 px-4 rounded-full" data-type="all">All</button>
                                <button class="filter-btn-type bg-stone-200 text-stone-700 py-2 px-4 rounded-full" data-type="Field Game">Field Games</button>
                                <button class="filter-btn-type bg-stone-200 text-stone-700 py-2 px-4 rounded-full" data-type="Team Time">Team Time</button>
                            </div>
                        </div>
                         <div>
                            <label class="font-bold text-stone-700">Filter by Location:</label>
                            <div id="location-filters" class="flex flex-wrap gap-2 mt-2">
                                <button class="filter-btn-location bg-teal-600 text-white py-2 px-4 rounded-full" data-location="all">All</button>
                                <button class="filter-btn-location bg-stone-200 text-stone-700 py-2 px-4 rounded-full" data-location="Outdoor">Outdoor</button>
                                <button class="filter-btn-location bg-stone-200 text-stone-700 py-2 px-4 rounded-full" data-location="Indoor">Indoor</button>
                                <button class="filter-btn-location bg-stone-200 text-stone-700 py-2 px-4 rounded-full" data-location="Both">Both</button>
                            </div>
                        </div>
                        <div>
                            <label for="material-filter-select" class="font-bold text-stone-700">Filter by Material:</label>
                            <select id="material-filter-select" class="mt-2 block w-full pl-3 pr-10 py-2 text-base border-stone-300 focus:outline-none focus:ring-teal-500 focus:border-teal-500 sm:text-sm rounded-md">
                                <option value="all">All Materials</option>
                                <!-- Options will be dynamically populated here -->
                            </select>
                        </div>
                    </div>
                </div>

                <div id="game-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div id="loading-indicator" class="col-span-full text-center text-stone-500 text-lg py-8">Loading activities...</div>
                </div>
            </section>
        </main>
    </div>

    <!-- Game Details Modal -->
    <div id="game-modal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto modal-content-scroll">
            <div class="sticky top-0 bg-white p-4 sm:p-6 border-b border-stone-200 flex justify-between items-center">
                <h2 id="modal-title" class="text-2xl sm:text-3xl font-bold text-teal-700"></h2>
                <button id="close-modal" class="text-stone-500 hover:text-red-600 transition-colors">
                    <span class="text-2xl font-bold">&times;</span>
                </button>
            </div>
            <div id="modal-content" class="p-4 sm:p-6">
            </div>
            <div class="p-4 sm:p-6 border-t border-stone-200 flex justify-end">
                <button id="move-to-trash-btn" class="bg-red-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-red-600 transition-colors text-sm">
                    Move to Trash
                </button>
            </div>
        </div>
    </div>

    <!-- Add Activity Modal -->
    <div id="add-activity-modal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto modal-content-scroll">
            <div class="sticky top-0 bg-white p-4 sm:p-6 border-b border-stone-200 flex justify-between items-center">
                <h2 class="text-2xl sm:text-3xl font-bold text-teal-700">Add New Activity</h2>
                <button id="close-add-activity-modal" class="text-stone-500 hover:text-red-600 transition-colors">
                    <span class="text-2xl font-bold">&times;</span>
                </button>
            </div>
            <form id="add-activity-form" class="p-4 sm:p-6 space-y-6">
                <div>
                    <label for="activity-name" class="block text-stone-700 font-bold mb-2">Activity Name <span class="text-red-500">*</span></label>
                    <input type="text" id="activity-name" name="name" required class="w-full p-3 border border-stone-300 rounded-md focus:ring-teal-500 focus:border-teal-500">
                </div>

                <div>
                    <label class="block text-stone-700 font-bold mb-2">Activity Type <span class="text-red-500">*</span></label>
                    <div class="flex flex-wrap gap-4">
                        <label class="inline-flex items-center">
                            <input type="radio" name="type" value="Field Game" class="form-radio text-teal-600" required>
                            <span class="ml-2 text-stone-700">Field Game</span>
                        </label>
                        <label class="inline-flex items-center">
                            <input type="radio" name="type" value="Team Time" class="form-radio text-teal-600">
                            <span class="ml-2 text-stone-700">Team Time</span>
                        </label>
                    </div>
                </div>

                <div>
                    <label class="block text-stone-700 font-bold mb-2">Location <span class="text-red-500">*</span></label>
                    <div class="flex flex-wrap gap-4">
                        <label class="inline-flex items-center">
                            <input type="radio" name="location" value="Outdoor" class="form-radio text-teal-600" required>
                            <span class="ml-2 text-stone-700">Outdoor</span>
                        </label>
                        <label class="inline-flex items-center">
                            <input type="radio" name="location" value="Indoor" class="form-radio text-teal-600">
                            <span class="ml-2 text-stone-700">Indoor</span>
                        </label>
                        <label class="inline-flex items-center">
                            <input type="radio" name="location" value="Both" class="form-radio text-teal-600">
                            <span class="ml-2 text-stone-700">Both</span>
                        </label>
                    </div>
                </div>

                <div>
                    <label for="objectives" class="block text-stone-700 font-bold mb-2">Objectives <span class="text-red-500">*</span></label>
                    <textarea id="objectives" name="objectives" rows="3" required class="w-full p-3 border border-stone-300 rounded-md focus:ring-teal-500 focus:border-teal-500"></textarea>
                </div>

                <div>
                    <label class="block text-stone-700 font-bold mb-2">Instructions <span class="text-red-500">*</span></label>
                    <div id="instructions-container" class="space-y-3">
                        <div class="instruction-item flex items-center gap-2">
                            <textarea name="instructions[]" rows="2" required class="w-full p-3 border border-stone-300 rounded-md focus:ring-teal-500 focus:border-teal-500" placeholder="e.g., Setup: Divide a large outdoor field..."></textarea>
                            <button type="button" class="remove-instruction-btn text-red-500 hover:text-red-700 text-xl font-bold">&times;</button>
                        </div>
                    </div>
                    <button type="button" id="add-instruction-btn" class="mt-3 bg-stone-200 text-stone-700 py-2 px-4 rounded-md hover:bg-stone-300 transition-colors">Add Instruction Step</button>
                </div>

                <div>
                    <label class="block text-stone-700 font-bold mb-2">Materials Needed</label>
                    <div id="materials-container" class="space-y-3">
                        <div class="material-item flex items-center gap-2">
                            <input type="text" name="materials[]" class="w-full p-3 border border-stone-300 rounded-md focus:ring-teal-500 focus:border-teal-500" placeholder="e.g., Water Guns (14)">
                            <button type="button" class="remove-material-btn text-red-500 hover:text-red-700 text-xl font-bold">&times;</button>
                        </div>
                    </div>
                    <button type="button" id="add-material-btn" class="mt-3 bg-stone-200 text-stone-700 py-2 px-4 rounded-md hover:bg-stone-300 transition-colors">Add Material</button>
                </div>

                <div>
                    <label for="safety-notes" class="block text-stone-700 font-bold mb-2">Safety Notes <span class="text-red-500">*</span></label>
                    <textarea id="safety-notes" name="safety" rows="3" required class="w-full p-3 border border-stone-300 rounded-md focus:ring-teal-500 focus:border-teal-500"></textarea>
                </div>

                <div>
                    <label for="supercharged-app" class="block text-stone-700 font-bold mb-2">SuperCharged Application <span class="text-red-500">*</span></label>
                    <textarea id="supercharged-app" name="supercharged" rows="3" required class="w-full p-3 border border-stone-300 rounded-md focus:ring-teal-500 focus:border-teal-500"></textarea>
                </div>

                <div class="flex justify-end">
                    <button type="submit" class="bg-teal-600 text-white font-semibold py-3 px-6 rounded-lg hover:bg-teal-700 transition-colors">Add Activity</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Deleted Activities Modal -->
    <div id="deleted-activities-modal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto modal-content-scroll">
            <div class="sticky top-0 bg-white p-4 sm:p-6 border-b border-stone-200 flex justify-between items-center">
                <h2 class="text-2xl sm:text-3xl font-bold text-teal-700">Deleted Activities</h2>
                <button id="close-deleted-activities-modal" class="text-stone-500 hover:text-red-600 transition-colors">
                    <span class="text-2xl font-bold">&times;</span>
                </button>
            </div>
            <div id="deleted-activities-list" class="p-4 sm:p-6 space-y-4">
                <!-- Deleted activities will be listed here -->
            </div>
        </div>
    </div>

    <!-- Confirmation Modal (for permanent delete) -->
    <div id="confirmation-modal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-sm p-6 text-center">
            <h3 class="text-xl font-bold text-red-700 mb-4">Confirm Permanent Deletion</h3>
            <p class="text-stone-700 mb-6">Are you sure you want to permanently delete this activity? This action cannot be undone.</p>
            <div class="flex justify-center gap-4">
                <button id="cancel-permanent-delete-btn" class="bg-stone-300 text-stone-800 font-semibold py-2 px-4 rounded-lg hover:bg-stone-400 transition-colors">Cancel</button>
                <button id="confirm-permanent-delete-btn" class="bg-red-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-red-700 transition-colors">Delete Permanently</button>
            </div>
        </div>
    </div>


    <script type="module">
        // Firebase Imports
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, query, orderBy, doc, updateDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Global Firebase variables
        let app;
        let db;
        let auth;
        let userId;

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCNMLCw5f1ajmGLHP9gnfzojcryUIufs6E",
            authDomain: "kids-camp-guide.firebaseapp.com",
            projectId: "kids-camp-guide",
            storageBucket: "kids-camp-guide.firebasestorage.app",
            messagingSenderId: "774110400277",
            appId: "1:774110400277:web:7e3b65313073e3aacf631c"
        };
        
        // For GitHub Pages, __app_id and __initial_auth_token are not automatically provided by the Canvas environment.
        // So, we'll derive the appId for Firestore collection path from firebaseConfig.appId
        // or default to 'default-app-id' if not found.
        const appId = firebaseConfig.appId || 'default-app-id';


        // Initial games data - these will be loaded first, then merged with user-added data from Firestore
        const initialGamesData = [
            {
                id: 'game1',
                name: "Minute to Win It Mayhem!",
                type: "Field Game",
                location: "Both",
                description: "A high-energy circuit of 60-second challenges. Teams rotate through various stations, accumulating points by completing diverse tasks that test skill, speed, and coordination.",
                objectives: "Fosters individual skill development, quick thinking, coordination, and team encouragement.",
                generalInstructions: [
                    "<strong>Overall Setup:</strong> Designate 5-7 distinct stations in your field or indoor space. Each station will host a unique Minute to Win It challenge. Ensure ample space between stations for safety and clear boundaries for each challenge area. Have a central timer (leader with a stopwatch and whistle) to signal start and stop for all stations simultaneously.",
                    "<strong>Team Formation:</strong> Divide campers into small teams (e.g., 4-6 campers per team). Assign each team a starting station.",
                    "<strong>Overall Game Play:</strong> On the first whistle, all teams begin their challenge at their assigned station. They have exactly 60 seconds to complete as much of the challenge as possible. A designated station leader will oversee each challenge, explain rules, ensure fair play, and record points.",
                    "<strong>Rotation:</strong> After 60 seconds, a second whistle signals the end of the round. Teams stop immediately, and station leaders tally points. Teams then quickly and safely rotate to the next designated station. This continues until all teams have visited all stations.",
                    "<strong>Overall Scoring:</strong> Points are awarded per station based on the specific challenge's scoring method. Station leaders record points for their team. A central scorekeeper compiles total points at the end. The team with the highest total points wins."
                ],
                stationInstructions: [
                    {
                        title: "Station 1: Balloon Defying Gravity",
                        content: `
                            <ul>
                                <li><strong>Setup:</strong> Clear an open space. Have 1-2 balloons per player ready.</li>
                                <li><strong>Goal:</strong> Keep a balloon from touching the ground for a full minute.</li>
                                <li><strong>How to Play:</strong> Each player gets a balloon. On 'Go!', players must keep their balloon in the air using any body part EXCEPT their hands (no holding!). The balloon must continually be moving.</li>
                                <li><strong>Scoring:</strong> 1 point for every 5 seconds a balloon stays airborne without hands (e.g., 12 points for a full minute). If a balloon touches the ground, that player is out for the remainder of the 60 seconds, or they can restart with a new balloon for a penalty (e.g., -5 points).</li>
                                <li><strong>Challenge Up:</strong> For more agile kids, allow only one hand, no hands at all, or add more than one balloon per player.</li>
                            </ul>
                        `
                    },
                    {
                        title: "Station 2: Fun Pong",
                        content: `
                            <ul>
                                <li><strong>Setup:</strong> Set up 10 plastic cups in a triangle formation at one end of a table. Fill them partially with water for stability. Mark a 'throwing line' at the opposite end of the table (approx. 5-10 feet away). Have a basket of ping pong balls ready.</li>
                                <li><strong>Goal:</strong> Get as many ping pong balls into cups as possible in one minute.</li>
                                <li><strong>How to Play:</strong> Players stand at the throwing line and try to toss ping pong balls into the cups. Players can retrieve their own balls or have a helper.</li>
                                <li><strong>Scoring:</strong> 1 point for each ball that successfully lands and stays in a cup. For an extra challenge, remove each cup a ball sinks into, making options smaller.</li>
                            </ul>
                        `
                    },
                    {
                        title: "Station 3: Rubber Band Shooting Gallery",
                        content: `
                            <ul>
                                <li><strong>Setup:</strong> Arrange 5-10 empty soda cans (or plastic bottles, small plastic cups) on a raised surface (e.g., a bench, small table) at varying distances. Mark a 'shooting line' 10-15 feet away. Provide a supply of rubber bands.</li>
                                <li><strong>Goal:</strong> Knock down as many cans as possible in one minute using rubber bands.</li>
                                <li><strong>How to Play:</strong> Players stand at the shooting line and fling rubber bands at the cans. They can shoot as quickly as they can reload.</li>
                                <li><strong>Scoring:</strong> 1 point for each can knocked completely off the surface. Cans are reset after each player's turn or after 60 seconds for the next team.</li>
                            </ul>
                        `
                    },
                    {
                        title: "Station 4: Sponge Run",
                        content: `
                            <ul>
                                <li><strong>Setup:</strong> Place a kiddie pool filled with water at one end of the designated area. Place an empty large bucket at the opposite end (approx. 20-30 feet away). Have a supply of sponges next to the kiddie pool.</li>
                                <li><strong>Goal:</strong> Transfer as much water as possible from the kiddie pool to the empty bucket using a sponge on their head, in one minute.</li>
                                <li><strong>How to Play:</strong> Players soak a sponge in the kiddie pool, place it on their head, and run across the yard to the empty bucket. They then squeeze the water from the sponge into the bucket and run back for another sponge. They cannot hold the sponge with their hands while running.</li>
                                <li><strong>Scoring:</strong> The team whose bucket has the most water (measure with a marked line or by volume) at the end of the minute wins that station's points. You can award points based on volume (e.g., 1 point per inch of water).</li>
                            </ul>
                        `
                    },
                    {
                        title: "Station 5: Frisbee Dunk",
                        content: `
                            <ul>
                                <li><strong>Setup:</strong> Place 3-4 kiddie pools (or large buckets/laundry baskets) at different distances from a throwing line (e.g., 10ft, 15ft, 20ft, 25ft). Assign different point values to each pool based on difficulty (e.g., closest = 5 points, furthest = 20 points). Have a supply of frisbees.</li>
                                <li><strong>Goal:</strong> Throw and 'dunk' frisbees into the pools for points in one minute.</li>
                                <li><strong>How to Play:</strong> Players stand at the throwing line and try to toss frisbees into the pools. Each player gets a set number of throws or can throw continuously for the minute.</li>
                                <li><strong>Scoring:</strong> Points are awarded based on the value of the pool the frisbee lands in. Frisbees must land completely inside the pool to count.</li>
                            </ul>
                        `
                    },
                    {
                        title: "Station 6: Dice Balance",
                        content: `
                            <ul>
                                <li><strong>Setup:</strong> Each player needs a popsicle stick and six dice. Have a flat, stable surface for players to stand or sit.</li>
                                <li><strong>Goal:</strong> Balance all six dice on the end of a popsicle stick held in their mouth.</li>
                                <li><strong>How to Play:</strong> On 'Go!', each player places one end of a popsicle stick in their mouth. They then attempt to stack all six dice, one by one, on the other end of the popsicle stick using only their hands. The dice must remain balanced for a count of 3 seconds.</li>
                                <li><strong>Scoring:</strong> The first player to successfully balance all six dice for 3 seconds wins that round for their team. If no one balances all six, the player with the most dice balanced at the end of 60 seconds wins. You can award points based on the number of dice balanced (e.g., 1 point per die).</li>
                            </ul>
                        `
                    }
                ],
                materials: ["Balloons (3 bags)", "Plastic Cups (100)", "Rubber Bands (1 large ziploc)", "Ping Pong Balls (suggested purchase - approx. 50)", "Old Soda Can (collect prior to camp)", "Kiddie Pools (4)", "Large Buckets (4)", "Sponges (21½ bags)", "Frisbees (26)", "Popsicle Sticks (various)", "Dice (approx. 30, for Dice Balance)", "Stopwatch (1)", "Whistle (2)", "Scoreboard (1)", "Pencils", "Cardstock Paper"],
                safety: "Ensure ample space between stations to prevent collisions. Supervise any water-related challenges closely to prevent slipping. Remind children to handle materials gently and avoid throwing items at others. Clear instructions on safe movement between stations are crucial. Emphasize no aiming rubber bands or frisbees at people. Ensure dice are clean for mouth contact.",
                supercharged: "Minute to Win It games challenge us to use our unique skills and talents quickly and effectively. Just like God has given each of us different gifts and abilities, these games show us how we can use those gifts – whether it's speed, precision, or balance – to do our best. It also reminds us to encourage our teammates, cheering them on even when things get tough, just as we should encourage one another in our faith journey. Every moment counts, both in the game and in how we live for God.",
                deleted: false // New field for soft delete
            },
            {
                id: 'game2',
                name: "The Ultimate Obstacle Relay",
                type: "Field Game",
                location: "Both",
                description: "Teams navigate a custom-built obstacle course combining various physical challenges in a relay format, emphasizing speed, agility, and teamwork.",
                objectives: "Enhances speed, coordination, collaborative problem-solving, and teamwork.",
                generalInstructions: [
                    "<strong>Overall Setup:</strong> Design and construct an obstacle course using available equipment. Aim for 3-5 distinct segments that require different movements (e.g., crawling under pool noodles, weaving through cones, jumping over hula hoops, balancing on a line, throwing a bean bag into a bucket). Ensure the course is clearly marked and safe. Example segments:",
                    "<ul>",
                    "<li><strong>Crawl Tunnel:</strong> Drape a tarp over two chairs or low obstacles to create a tunnel to crawl through.</li>",
                    "<li><strong>Cone Weave:</strong> Place 5-7 cones in a zig-zag pattern for players to weave around.</li>",
                    "<li><strong>Hula Hoop Hop:</strong> Lay 5-7 hula hoops on the ground in a line or zig-zag for players to hop into each one.</li>",
                    "<li><strong>Balance Beam:</strong> Lay a long rope or masking tape line on the ground for players to walk across without stepping off.</li>",
                    "<li><strong>Target Toss:</strong> Place a bucket or laundry basket a short distance away for players to throw a bean bag into.</li>",
                    "</ul>",
                    "<strong>Team Formation:</strong> Divide campers into equal teams. Have each team line up single-file behind a designated starting line.",
                    "<strong>Relay Start:</strong> On the 'Go!' signal, the first team member from each team begins navigating the first segment of the obstacle course.",
                    "<strong>Segment Completion & Tag:</strong> Once a player completes a segment, they must perform a designated 'tag' (e.g., high-five, tap on the shoulder) to the next teammate in line. The next teammate then proceeds through their assigned segment. For longer courses, you may have players complete the entire course before tagging the next teammate.",
                    "<strong>Course Progression:</strong> The relay continues with teammates completing segments in sequence. If a player fails a segment (e.g., steps off the balance beam, misses the target toss), they must restart that segment until successful.",
                    "<strong>Winning:</strong> The first team to have all its members successfully complete the entire obstacle course wins. Emphasize teamwork and encouragement throughout."
                ],
                materials: ["Pool Noodles (36)", "Inflatable Balls (3)", "Cones (various)", "Hula Hoops (25)", "Bean Bags (10)", "Wooden Blocks (32)", "Buckets (various)", "Tennis Balls (50+)", "Frisbees (26)", "Masking Tape or Rope", "White Tarp (1)"],
                safety: "Clear the play area of any tripping hazards. Emphasize safe running, crawling, and proper equipment handling. Close supervision is essential, especially during balance tasks or segments that involve climbing/crawling. Ensure obstacles are stable and won't tip over.",
                supercharged: "Just like navigating an obstacle course requires teamwork and perseverance, our faith journey often presents challenges that we can overcome with God's help and the support of our community. Each obstacle represents a hurdle, and with every step, we learn to trust God more and rely on each other. What 'obstacles' in your life can you ask God and your friends to help you navigate?",
                deleted: false
            },
            {
                id: 'game3',
                name: "Water Gun Capture the Flag",
                type: "Field Game",
                location: "Outdoor",
                description: "A refreshing twist on the classic game. Teams use water guns and sponges to tag opponents while trying to capture the other team's 'flag'—a bucket of water.",
                objectives: "Enhances strategic thinking, teamwork, agility, and communication.",
                generalInstructions: [
                    "<strong>Setup:</strong> Divide a large outdoor field into two distinct halves using cones or natural boundaries. Place a large, clearly visible bucket of water (the 'flag') deep within each team's territory. Set up a 'jail' area for each team, clearly marked (e.g., a small square of cones). Ensure there are water refill stations for water guns near the boundaries.",
                    "<strong>Team Formation:</strong> Divide campers into two equal teams. Provide each player with a water gun and/or a small sponge.",
                    "<strong>Tagging Rules:</strong> Players are 'tagged' if they are hit by water from an opponent's water gun or touched by a soaked sponge thrown by an opponent. Once tagged, a player must immediately go to the opposing team's designated 'jail' area. Players cannot be tagged while in their own 'jail' or while returning from 'jail' to their own territory after being freed.",
                    "<strong>Jail Break:</strong> A player in 'jail' can be freed if a teammate tags them without being tagged themselves. Once freed, they can re-enter the game. Only one player can be freed at a time by a single rescuer.",
                    "<strong>Capturing the Flag:</strong> To win, a player must sneak into the opponent's territory, reach their 'flag' (bucket of water), soak a sponge in it, and then carry that soaked sponge back to their own territory without being tagged. If they are tagged while carrying the soaked sponge, they go to jail, and the sponge is returned to the opponent's flag bucket. The sponge must be carried, not thrown, once soaked.",
                    "<strong>Winning:</strong> The first team to successfully capture the opponent's 'flag' (soaked sponge) and bring it back to their own side wins the round. Play multiple rounds for best of three or five."
                ],
                materials: ["Water Guns (14)", "Sponges (21½ bags)", "Large Buckets (various)", "Cones", "Kiddie Pools (for water refills)", "Whistles (2)"],
                safety: "Strict rule: Aim water only at the body, never at faces or heads. Emphasize no running with water guns pointed at others. Supervise water refills to prevent slipping hazards. Ensure the playing field is free of obstacles that could cause trips. Remind players to be aware of their surroundings and not to run into others.",
                supercharged: "In Capture the Flag, we work together to achieve a common goal, just like in our faith, we are part of God's team, working to spread His love and truth. Sometimes we need to be strategic, sometimes we need to rescue others, and sometimes we need to protect what's important. How can we be good teammates for God's kingdom?",
                deleted: false
            },
            {
                id: 'game4',
                name: "Human Foosball Frenzy",
                type: "Field Game",
                location: "Both",
                description: "Players link arms or hold onto pool noodles in rows, restricted to side-to-side movement like a foosball table. They must work together to kick a large ball into the opponent's goal.",
                objectives: "Emphasizes coordination, teamwork, spatial awareness, and constant communication.",
                generalInstructions: [
                    "<strong>Setup:</strong> Create a large rectangular playing area (e.g., 30ft x 15ft) using cones or boundary markers. Inside this area, use ropes or pool noodles to create 3-4 parallel 'lanes' across the width of the field. Players will stand in these lanes, holding onto the rope/noodle. Place a goal (e.g., two cones spaced apart) at each end of the rectangle. The ball should be an inflatable beach ball or similar large, lightweight ball.",
                    "<strong>Team Formation:</strong> Divide campers into two equal teams. Assign each player to a specific lane. Players in the same lane on opposing teams will face each other. Players must hold onto a rope or pool noodle, restricting them to only move horizontally within their lane. They cannot move forward or backward out of their designated lane. Ensure an equal number of players per lane, or adjust lane sizes accordingly.",
                    "<strong>Game Start:</strong> Place the large inflatable ball in the center of the playing area. On the whistle, the game begins.",
                    "<strong>Game Play:</strong> Players must work together within their restricted horizontal movement to pass the ball to teammates in other lanes and eventually shoot it into the opponent's goal. Players can only use their feet to kick the ball. If the ball goes out of bounds, it is returned to the nearest boundary line and put back into play by the team that did not cause it to go out (e.g., a simple kick-in from the sideline).",
                    "<strong>Scoring:</strong> A point is scored when the ball successfully enters the opponent's goal. After a goal, the ball is returned to the center for a restart.",
                    "<strong>Winning:</strong> Play for a set time (e.g., 15-20 minutes) or until one team reaches a target score (e.g., 5-7 goals). The team with the most points at the end wins."
                ],
                materials: ["Pool Noodles (36)", "Inflatable Ball", "Cones (for goals and boundaries)", "Whistles (2)"],
                safety: "Emphasize no excessive pulling or pushing on the ropes/noodles to prevent injury. Ensure the playing surface is even and free of obstacles. Supervise closely to prevent collisions, especially when players are moving quickly sideways. Remind players to be mindful of their teammates' positions and to avoid kicking too hard or at other players.",
                supercharged: "In Human Foosball, we're all connected and have to move together to achieve our goal. This reminds us that in God's family, we are all connected, and we need to work together, communicate, and support each other to reach our spiritual goals. How can we better connect and communicate with others in our faith community?",
                deleted: false
            },
            {
                id: 'game5',
                name: "Human Tic-Tac-Toe Relay",
                type: "Field Game",
                location: "Both",
                description: "Transforms tic-tac-toe into a dynamic team relay. Teams race to place markers on a giant grid, aiming for three in a row.",
                objectives: "Enhances speed, strategic thinking, teamwork, and coordination.",
                generalInstructions: [
                    "<strong>Setup:</strong> Use masking tape, rope, or cones to create a large 3x3 tic-tac-toe grid on the floor or ground (e.g., each square 3ft x 3ft). Designate a clear start line about 15-20 feet away from the grid. Ensure enough space around the grid for players to run.",
                    "<strong>Team Formation:</strong> Divide campers into two equal teams (Team X and Team O). Provide each team with a distinct set of 5-6 markers (e.g., Team X uses frisbees, Team O uses bean bags). Each team lines up single-file behind their respective start line.",
                    "<strong>Relay Start:</strong> On 'Go!', the first player from Team X runs from their start line to the tic-tac-toe grid. They place one of their team's markers into any empty square on the grid. After placing the marker, they run back and 'tag' (e.g., high-five) to the next teammate in line.",
                    "<strong>Alternating Turns:</strong> Immediately after Team X's player tags their teammate, the first player from Team O runs to the grid, places their marker in an empty square, and runs back to tag their next teammate. Teams alternate turns in this relay fashion.",
                    "<strong>Moving Markers (if grid is full):</strong> If the grid becomes full (all 9 squares have markers) and no one has three in a row, players can then choose to move one of their *existing* markers from one square to another *empty* square to try and get three in a row. They still must run to the grid, move the marker, and run back to tag. They cannot move an opponent's marker.",
                    "<strong>Winning:</strong> The game continues until one team successfully gets three of their markers in a row (horizontally, vertically, or diagonally). The first team to achieve this wins the round. Play multiple rounds for best of three or five."
                ],
                materials: ["Masking Tape or Rope", "Frisbees (26)", "Bean Bags (10)", "Plastic Balls (2 bags)", "Cones (various)", "Whistles (2)", "Stopwatch (1)"],
                safety: "Ensure the play area is clear of tripping hazards. Emphasize safe running and avoiding collisions, especially when multiple players are moving near the grid. Remind children to place markers gently and not to throw them at others. Ensure players do not interfere with opponents' turns.",
                supercharged: "In Human Tic-Tac-Toe, we need to think ahead and work together to achieve our goal. This is like our spiritual walk, where we need to be strategic in how we live our lives for God, making wise choices and working with others in the Body of Christ to advance His kingdom. How can we be more intentional in our daily choices to honor God?",
                deleted: false
            },
            {
                id: 'game6',
                name: "Indoor Bowling Bonanza",
                type: "Field Game",
                location: "Indoor",
                description: "Classic bowling game indoors. Teams roll a bowling ball or inflatable ball to knock down pins or stacked plastic cups.",
                objectives: "Enhances aim, strategy, and teamwork.",
                generalInstructions: [
                    "<strong>Setup:</strong> Choose a long, clear indoor space (e.g., gym, large hall). At one end, set up 10 bowling pins in a standard triangle formation (1-2-3-4 formation), or stack 10 plastic cups in a pyramid (4-3-2-1 formation). Mark a clear 'rolling line' about 15-20 feet away from the pins using masking tape. Ensure there is enough space for the ball to roll and for players to stand safely.",
                    "<strong>Team Formation:</strong> Divide campers into small teams (e.g., 3-5 players per team). Each team will take turns bowling.",
                    "<strong>Game Play:</strong> A player from the first team stands behind the rolling line and rolls the bowling ball (or inflatable ball) towards the pins/cups. They get two rolls per turn, just like in traditional bowling, to knock down as many as possible. Players must remain behind the rolling line until the ball has stopped.",
                    "<strong>Scoring:</strong> Points are awarded for each pin/cup knocked down (e.g., 1 point per pin). A perfect strike (all 10 pins on the first roll) can earn bonus points (e.g., 15 points). A spare (all 10 pins on two rolls) can earn a slightly smaller bonus (e.g., 12 points). Keep score on a whiteboard or large paper. After a player's turn, the pins are reset.",
                    "<strong>Winning:</strong> Play for a set number of rounds (e.g., 5-10 rounds per team) or until a target score is reached. The team with the most points at the end wins."
                ],
                materials: ["Bowling Ball (1)", "Bowling Pins (10)", "Plastic Cups (100)", "Inflatable Balls (3)", "Masking Tape", "Cones", "Scoreboard (1)", "Pencils", "Cardstock Paper", "Whistles (2)", "Stopwatch (1)"],
                safety: "Ensure the rolling area is clear and dry to prevent slipping. Remind children to roll, not throw, the ball, and to keep it low to the ground. Supervise closely to ensure children are not in the ball's path, especially when pins are being reset. Designate clear 'return' paths for the ball and ensure players wait until the ball is stationary before approaching the pins.",
                supercharged: "Bowling requires focus and aiming for a target. In our spiritual lives, we are called to 'aim' for God's purposes, staying focused on Him and His will. Even if we miss sometimes, we get another chance, just like in bowling. What are some spiritual targets you can aim for this week?",
                deleted: false
            },
            {
                id: 'game7',
                name: "Giant Slingshot Target Challenge",
                type: "Field Game",
                location: "Both",
                description: "Teams test aim and precision using slingshots to launch projectiles at targets for points.",
                objectives: "Enhances aim, precision, teamwork, and coordination.",
                generalInstructions: [
                    "<strong>Setup:</strong> Designate a clear 'shooting line' using tape or cones. Set up various targets at different distances from the shooting line, assigning different point values to each target (e.g., closer targets = 5 points, medium = 10 points, furthest/smallest = 20 points). Targets can include buckets, laundry baskets, hula hoops laid flat, or stacked plastic cups. Ensure a clear and safe backstop behind the targets to contain projectiles. Provide each team with a slingshot and a supply of soft, safe projectiles (e.g., tennis balls, plastic balls, crumpled paper, small clay balls).",
                    "<strong>Team Formation:</strong> Divide campers into small teams (e.g., 3-5 players per team). Each team will take turns shooting.",
                    "<strong>Game Play:</strong> Teams send one player at a time to the shooting line. The player uses the slingshot to launch a projectile at the targets. They get a set number of shots per turn (e.g., 3-5 shots). After shooting, the player retrieves their projectiles (if safe to do so and not interfering with other players) and returns to tag the next player in line. Only one player should be at the shooting line at a time.",
                    "<strong>Scoring:</strong> Points are tallied for successful hits on targets. Projectiles must hit or land inside the target to count. A designated scorekeeper records points for each team.",
                    "<strong>Winning:</strong> The game continues for a set time (e.g., 20-30 minutes) or until all players have had a predetermined number of turns. The team with the highest total score at the end wins."
                ],
                materials: ["Sling Shots (4)", "Tennis Balls (50+)", "Plastic Balls (2 bags)", "Bean Bags (10)", "Cotton Balls (suggested purchase)", "Large Buckets (various)", "Laundry Baskets (11)", "Tiny Garbage Cans (9)", "Cones", "Hula Hoops (25)", "Scoreboard (1)", "Pencils", "Cardstock Paper", "Whistles (2)", "Stopwatch (1)"],
                safety: "<strong>Strict Rules:</strong> Emphasize aiming ONLY at designated targets, NEVER at people or animals. Ensure a clear safety zone around targets and behind the shooter where no one should stand. Projectiles MUST be soft and harmless. Supervise closely to ensure proper and safe use of slingshots and projectiles. Collect projectiles promptly to prevent tripping hazards. Ensure no one walks in front of the shooter.",
                supercharged: "Just like we aim for targets with the slingshot, in our faith, we aim to live lives that honor God and hit the mark of His calling. Sometimes it takes practice and patience. What are some ways we can practice aiming for God's will in our daily lives?",
                deleted: false
            },
            {
                id: 'game8',
                name: "Sponge Ball Toss",
                type: "Field Game",
                location: "Both",
                description: "Teams throw sponges or bean bags at various targets for points, testing their aim and precision.",
                objectives: "Enhances aim, precision, and teamwork.",
                generalInstructions: [
                    "<strong>Setup:</strong> Designate a 'throwing line' using tape or cones. Set up various targets at different distances and heights, assigning different point values (e.g., closer targets = 5 points, higher/further = 10 points). Targets can include large buckets, laundry baskets, hula hoops, or even leaders holding targets. Ensure a clear area for throws and where projectiles will land. Provide each team with a supply of sponges or bean bags.",
                    "<strong>Team Formation:</strong> Divide campers into small teams (e.g., 3-5 players per team). Each team will take turns throwing.",
                    "<strong>Game Play:</strong> Teams send one player at a time to the throwing line. The player throws a set number of sponges/bean bags (e.g., 3-5 throws) at the targets. After their throws, the player retrieves their projectiles (if safe to do so and not interfering with other players) and returns to tag the next player in line. Only one player should be at the throwing line at a time.",
                    "<strong>Scoring:</strong> Points are tallied for successful hits on targets. Projectiles must hit or land inside the target to count. A designated scorekeeper records points for each team.",
                    "<strong>Optional: Deflectors:</strong> For an added challenge, leaders can hold pool noodles to act as deflectors, making it harder to hit targets. Ensure deflectors are held safely and do not interfere with the throwing motion.",
                    "<strong>Winning:</strong> The game continues for a set time (e.g., 20-30 minutes) or until all players have had a predetermined number of turns. The team with the highest total score at the end wins."
                ],
                materials: ["Sponges (21½ bags)", "Bean Bags (10)", "Large Buckets (various)", "Laundry Baskets (11)", "Tiny Garbage Cans (9)", "Cones", "Hula Hoops (25)", "Scoreboard (1)", "Pencils", "Cardstock Paper", "Whistles (2)", "Stopwatch (1)", "Pool Noodles (36)"],
                safety: "Ensure the throwing area is clear of obstacles. Remind children to throw gently, only at designated targets, and never at people. Supervise closely to ensure safe throwing and retrieval of projectiles. Ensure no one walks in front of the thrower.",
                supercharged: "Tossing a sponge at a target requires focus and a steady hand. In life, we are called to be 'on target' with God's will, using our gifts to serve others with precision and care. When we aim to serve God, we can make a big impact. What are some ways you can 'hit the target' by serving others this week?",
                deleted: false
            },
            {
                id: 'game9',
                name: "Bed Sheet Volleyball/Ping Pong",
                type: "Field Game",
                location: "Both",
                description: "Teams use a large bed sheet held taut to volley an inflatable ball over a net or designated line, mimicking volleyball or ping pong.",
                objectives: "Enhances coordination, teamwork, communication, and hand-eye coordination.",
                generalInstructions: [
                    "<strong>Setup:</strong> Divide the playing area (field or gym) into two halves. Set up a 'net' in the middle: if outdoors, string a rope between two poles or trees at a height appropriate for the campers; if indoors, use a line of cones or masking tape on the floor. Provide each team with a large bed sheet (at least twin size, larger is better for more players) and an inflatable ball (e.g., beach ball).",
                    "<strong>Team Formation:</strong> Divide campers into two equal teams. Each team will gather around their bed sheet, holding the edges of the sheet taut with both hands. The number of players per sheet depends on the sheet size (e.g., 4-8 players per sheet). All players must hold onto the sheet at all times during play.",
                    "<strong>Game Play:</strong> To start, one team places the inflatable ball on their taut bed sheet. Working together, they must use the sheet to launch the ball over the 'net' to the opposing team's side. The opposing team must then try to 'catch' the ball on their sheet without letting it touch the ground. Once caught, they must volley it back over the net. The ball must go over the net and land within the opposing team's boundaries.",
                    "<strong>Scoring:</strong> A point is scored when: <br> - The ball hits the ground on the opponent's side of the net (within bounds). <br> - The ball goes out of bounds. <br> - A team drops the ball (fails to catch it on their sheet). <br> - The ball hits the net and doesn't go over. <br> The team that scores the point gets to serve the ball for the next round.",
                    "<strong>Winning:</strong> Play to a predetermined score (e.g., first to 15 points, winning by 2) or for a set time limit (e.g., 15-20 minutes). The team with the most points at the end wins."
                ],
                materials: ["Bed sheets (2 large - suggested camp supply)", "Inflatable Balls (3)", "Rope (7 available)", "Masking Tape (3 rolls)", "Cones (various)", "Whistles (2)"],
                safety: "Ensure players are spaced out around the sheet to avoid collisions and accidental hitting. Remind children to hold the sheet firmly and not to let go suddenly. Ensure the playing area is clear of obstacles. Supervise closely to prevent excessive pulling or tugging on the sheet that could cause falls. Emphasize that players should not swing the sheet at other players.",
                supercharged: "Bed Sheet Volleyball shows us how important it is to work together, communicate, and support each other. Just like everyone holding the sheet has a role, every person in God's family has a unique role to play, and we need each other to succeed. How can you better support your friends and family in their faith journeys?",
                deleted: false
            },
            {
                id: 'game10',
                name: "Kiddie Pool Treasure Hunt",
                type: "Field Game",
                location: "Outdoor",
                description: "Campers search for hidden 'treasures' submerged in kiddie pools, often blindfolded or using only their feet, relying on touch and teamwork.",
                objectives: "Enhances tactile exploration, problem-solving, and communication (if guided).",
                generalInstructions: [
                    "<strong>Setup:</strong> Place several small kiddie pools in a designated outdoor area. Fill each pool with water to a depth that allows treasures to be submerged but is safe for children. Submerge various 'treasures' at the bottom of the pools (e.g., fake gold coins, plastic critters, diving octopi, weighted plastic balls). Ensure the treasures are safe to handle, clean, and easily distinguishable by touch. Have blindfolds or bandanas ready.",
                    "<strong>Team Formation:</strong> Divide campers into teams. Each team will take turns sending one or two players to search the pools.",
                    "<strong>Game Play (Option 1 - Blindfolded):</strong> One player from a team is blindfolded. They approach a pool and, guided verbally by their non-blindfolded teammates, attempt to find and retrieve as many treasures as possible within a set time limit (e.g., 60-90 seconds). The blindfolded player cannot see, relying entirely on their teammates' instructions. Teammates must stay outside the pool and can only use verbal commands (e.g., 'left a little', 'straight ahead', 'feel with your foot').",
                    "<strong>Game Play (Option 2 - Feet Only):</strong> Players are not blindfolded but must use only their feet/toes to search for and retrieve treasures from the bottom of the pool. No hands allowed. This can be done individually or as a relay.",
                    "<strong>Scoring:</strong> After the time limit, count the treasures collected by the player. The treasures are then returned to the pool for the next team. The team with the most treasures collected at the end wins. You can assign different point values to different types of treasures if desired.",
                    "<strong>Rotation:</strong> Teams rotate through the pools until all players have had a turn, or for a set number of rounds."
                ],
                materials: ["Small Kiddie Pools (4)", "Fake Gold Coins (approx 130)", "Plastic Critters (2 large ziplocks)", "Small Plastic Dinosaurs (30)", "Diving Octopi (1 set of 6)", "Blindfolds (or Bandanas - approx. 70)", "Whistles (2)", "Stopwatch (1)"],
                safety: "Ensure pools are on a flat, stable surface to prevent tipping. Supervise children closely around water to prevent splashing into eyes or accidental falls. Remind children not to push or splash excessively. Ensure all submerged 'treasures' are clean, smooth, and safe to handle. Emphasize calm and clear communication for blindfolded players to avoid disorientation.",
                supercharged: "Searching for treasure reminds us of seeking God's truth and wisdom. Sometimes it feels like we're blindfolded, but God provides guides (like the Holy Spirit and wise mentors) to help us find the precious truths hidden in His Word. What 'treasures' (truths) have you found in the Bible lately?",
                deleted: false
            },
            {
                id: 'game11',
                name: "The Great Camp Invention Challenge",
                type: "Team Time",
                location: "Indoor",
                description: "Teams receive a mystery box of random items and a camp-related problem. They must invent a solution, build a prototype, and present it with a jingle.",
                objectives: "Fosters creativity, collaborative problem-solving, communication, and presentation skills.",
                generalInstructions: [
                    "<strong>Setup:</strong> Prepare 'mystery boxes' for each team. Each box should contain a variety of random, safe, and diverse items (e.g., cardboard, popsicle sticks, rubber bands, plastic spoons, plastic cups, yarn, CDs, pipe cleaners, small plastic toys, empty paper towel rolls, fabric scraps, string, paper clips, aluminum foil). Also, prepare a 'problem prompt' for each team written on a card (e.g., 'Invent a device to help campers make new friends', 'Create a system to keep tents tidy', 'Design a way to make Bible study more fun', 'Build a tool to help carry supplies'). Provide basic tools like glue sticks, white glue, tape, and scissors.",
                    "<strong>Team Formation:</strong> Divide campers into small teams (e.g., 4-6 campers per team). Give each team a mystery box and a problem prompt. Designate a workspace for each team.",
                    "<strong>Brainstorm & Build (30-40 minutes):</strong> Teams have this time to brainstorm ideas, design their invention, and build a prototype using *only* the materials in their mystery box. Encourage them to think creatively and collaboratively. Remind them that the prototype doesn't have to be perfect, but it should clearly demonstrate their idea.",
                    "<strong>Jingle Creation (during building time):</strong> During the building time, teams must also create a short, catchy jingle or slogan for their invention. The jingle should explain its purpose and benefits in a fun, memorable way (e.g., a short song, a rhyme, a cheer).",
                    "<strong>Presentation (5-7 minutes per team):</strong> After the building time, each team presents their invention to the larger group. They should explain: <br> 1. The problem they addressed. <br> 2. How their invention works and what it does. <br> 3. What materials they used and why. <br> 4. Perform their jingle/slogan. <br> Encourage questions from other teams after each presentation.",
                    "<strong>Judging/Awards:</strong> Leaders can award points or fun prizes for categories such as: Most Creative Invention, Best Teamwork, Funniest Jingle, Most Practical Solution, Best Presentation, etc."
                ],
                materials: ["Cardboard Boxes (2)", "Popsicle Sticks (various)", "Rubber Bands (various)", "Plastic Critters (2 large ziplocks)", "Foam Beads (1 bag ziplocks)", "Yarn (various)", "CDs (17)", "Skewers (various)", "Toothpicks (500)", "Plastic Cups (100)", "Wooden Blocks (32)", "Construction Paper (various)", "Washable Markers (various)", "Glue Sticks (various)", "White Glue Bottles (11)", "Scissors (various)", "Stopwatch (1)", "Masking Tape", "Scotch Tape", "Aluminum Foil (suggested purchase)"],
                safety: "Ensure all mystery box items are safe for children to handle. Supervise the use of scissors and glue carefully. Remind children not to put small items in their mouths. Ensure the building area is tidy to prevent tripping hazards. Emphasize that inventions should be demonstrated safely and not used to hit or harm others.",
                supercharged: "This challenge reminds us that God has given us creativity and problem-solving skills. He wants us to use our minds and talents to find solutions, just like we invented things today. How can you use your creativity to solve problems or bless others in your life?",
                deleted: false
            },
            {
                id: 'game12',
                name: "Minefield & Power-Up Scavenger Hunt",
                type: "Team Time",
                location: "Both",
                description: "Blindfolded players navigate a 'minefield' of soft obstacles, guided verbally by teammates to collect 'power-ups' representing Foursquare values.",
                objectives: "Enhances trust, communication, active listening, teamwork, and reinforces camp values.",
                generalInstructions: [
                    "<strong>Setup:</strong> In an open indoor or outdoor area, scatter 'mines' (e.g., cones, bean bags, soft objects like small balls or crumpled paper) randomly across the space. These are obstacles to be avoided. Then, strategically place 'power-up' items (e.g., laminated Bible verses, rubber ducks, fake gold coins, small plastic critters, wooden blocks, small laminated pictures representing Foursquare values) throughout the minefield. Ensure power-ups are distinct from mines and easily identifiable by touch or by a quick verbal description from guides. Have blindfolds or bandanas ready.",
                    "<strong>Team Formation:</strong> Divide campers into small teams (e.g., 3-5 campers per team). Each team will designate one player to be the 'navigator' (blindfolded) and the rest will be 'guides'. Teams should have a designated 'collection zone' for their power-ups.",
                    "<strong>Game Play:</strong> The navigator is blindfolded and stands at the edge of the minefield. On 'Go!', the guides must use only verbal instructions (no touching, pointing, or physical contact!) to direct their blindfolded navigator through the minefield. The goal is to collect as many 'power-ups' as possible while avoiding touching any 'mines'. Once a power-up is found, the navigator must bring it back to their team's collection zone before seeking another.",
                    "<strong>Mine Penalty:</strong> If the navigator touches a 'mine', they must immediately stop. The guides must then verbally direct them back to the starting point of that specific segment of the minefield (or the beginning of the entire minefield, depending on desired difficulty) before they can continue their search.",
                    "<strong>Scoring:</strong> Teams earn points for each 'power-up' successfully collected and brought back to their collection zone. The game can be timed (e.g., 10-15 minutes), with the team collecting the most power-ups in that set time winning, or the first team to collect all designated power-ups winning. Rotate navigators within each team so everyone gets a chance to experience both roles.",
                    "<strong>Guide Communication:</strong> Emphasize clear, concise, and calm verbal guidance. Guides should use directional words (e.g., 'take two steps forward', 'turn slightly left', 'mine on your right', 'power-up directly in front')."
                ],
                materials: ["Cones (various)", "Bean Bags (10)", "Whistles (2)", "Blindfolds (or Bandanas - approx. 70)", "Laminated Bible Chapter Names (2 sets)", "Rubber Duckies (44)", "Fake Gold Coins (approx 130)", "Plastic Critters (2 large ziplocks)", "Wooden Blocks (32)", "Plastic Balls (2 bags)", "Laminated Foursquare Symbols/Values (suggested purchase)"],
                safety: "Ensure the play area is completely clear of actual hazards (e.g., sharp objects, uneven ground). Use only soft 'mines' that won't cause injury if stepped on. Supervise closely to prevent collisions between blindfolded players or with static objects. Emphasize gentle, clear, and calm verbal guidance from the guides. No running for blindfolded players. Guides must ensure the path is clear before giving 'go ahead' commands.",
                supercharged: "Navigating the minefield blindfolded teaches us to trust and listen to our guides. In life, God is our ultimate guide, and we can trust His Word and the wisdom of those He places in our lives. The 'power-ups' represent the spiritual blessings and truths we find when we follow His guidance. What are some ways you can listen more closely to God's guidance this week?",
                deleted: false
            },
            {
                id: 'game13',
                name: "Camp Code Breakers",
                type: "Team Time",
                location: "Indoor",
                description: "Campers use logic and communication to decode secret messages (substitution ciphers, bead sequences). Decoded messages reveal Foursquare values, Bible verses, or clues.",
                objectives: "Enhances problem-solving, logical thinking, communication, critical thinking, and subtly reinforces camp values.",
                generalInstructions: [
                    "<strong>Setup:</strong> Create 3-5 encrypted messages for each team. Ensure the messages are progressive, with one leading to the next. Examples include: <br> - <strong>Substitution Cipher:</strong> Each letter is replaced by another (e.g., A=Z, B=Y, or a simple shift cipher like A=C, B=D). Provide a small, clear key (e.g., 'A=Z', 'B=Y') for the first message, or make it a simple pattern they can deduce. <br> - <strong>Number Code:</strong> Each letter corresponds to a number (e.g., A=1, B=2). Provide a number-to-letter key. <br> - <strong>Bead Sequence:</strong> A sequence of colored beads represents a word or phrase (e.g., Red-Blue-Green = 'Faith', Yellow-Yellow-Red = 'Love'). Provide a clear legend for the bead code. <br> The decoded messages should reveal Foursquare values, short Bible verses, or clues leading to the next message. Place the first message and any necessary decoding tools (pencils, paper, bead legend, cipher key) in a sealed envelope labeled for each team.",
                    "<strong>Team Formation:</strong> Divide campers into small teams (e.g., 3-5 players per team). Give each team their first encrypted message envelope and a clipboard/writing surface.",
                    "<strong>Game Play:</strong> Teams collaboratively work to decode their message. They must use the provided key or their own logic to figure out the code. Encourage discussion and collaboration within the team. Once a message is decoded, they show it to a leader to verify. If correct, the leader provides the next encrypted message or clue. If incorrect, the leader can give a small hint (e.g., 'check your second word') and send them back to try again.",
                    "<strong>Winning:</strong> The game continues until all messages are decoded, leading to a final message (e.g., 'You have unlocked the secret of teamwork!') or a small 'treasure' (e.g., a bag of fake gold coins, a small treat). The first team to successfully decode all messages wins."
                ],
                materials: ["ABC Beads (3 sets)", "Colored Beads (3 sets)", "Pencils (various)", "Pens (3)", "Cardstock Paper (50)", "Construction Paper (various)", "Washable Markers (various)", "Sticky Notes (various)", "Laminated Bible Chapter Names (2 sets)", "Small Metal Cups (6)", "Plastic Critters (2 large ziplocks)", "Clipboards (4)", "Stopwatch (1)", "Envelopes"],
                safety: "Ensure all materials are safe for children to handle. Keep the area organized to prevent clutter. Remind children not to put small items in their mouths. Emphasize fair play and not peeking at other teams' solutions.",
                supercharged: "Decoding messages requires careful thought and teamwork, just like understanding God's Word requires us to study and seek His truth together. The 'secrets' we uncover in the Bible reveal more about God's plan and love for us. What 'messages' is God speaking to you through His Word right now?",
                deleted: false
            },
            {
                id: 'game14',
                name: "The Great Camp Contraption Challenge",
                type: "Team Time",
                location: "Indoor",
                description: "Teams design and build a Rube Goldberg-esque contraption using camp supplies to achieve a simple task (e.g., move an object, pop a balloon).",
                objectives: "Fosters engineering design, creative problem-solving, collaborative planning, and understanding of cause-and-effect.",
                generalInstructions: [
                    "<strong>Setup:</strong> Designate a building area for each team (e.g., a section of a table or floor, or a designated corner). Provide each team with a diverse assortment of safe, random camp materials (e.g., cardboard, popsicle sticks, rubber bands, plastic cups, string, small plastic balls, CDs, tape, glue, empty bottles/cans, paper towel rolls, marbles, dominoes). Clearly state the simple task their contraption must achieve (e.g., 'move a small object from Point A to Point B', 'pop a balloon', 'ring a bell', 'turn a page', 'drop a coin into a cup'). Provide a target object for the task (e.g., a specific small ball to move, a balloon to pop).",
                    "<strong>Team Formation:</strong> Divide campers into small teams (e.g., 4-6 campers per team). Present the challenge and the available materials.",
                    "<strong>Brainstorm & Design (10-15 minutes):</strong> Teams have this initial time to brainstorm ideas and sketch out a plan for their contraption. Encourage them to think about cause-and-effect sequences and how one action will lead to the next. Provide large paper and markers for sketching.",
                    "<strong>Build & Test (30-40 minutes):</strong> Teams then have this time to build their contraption. Emphasize that it's okay to try, fail, and adjust their design – this is part of the engineering process. They should test sections as they build to ensure each step works. Leaders should circulate to offer guidance, answer questions, and provide encouragement.",
                    "<strong>Presentation & Demonstration (5-7 minutes per team):</strong> After the building time, each team presents their contraption to the group. They should explain their design process, the challenges they faced, and then attempt to demonstrate their contraption achieving the designated task. It's perfectly fine if it doesn't work perfectly on the first try – learning from failure is part of the fun! Allow multiple attempts if time permits.",
                    "<strong>Discussion:</strong> Facilitate a discussion about the challenges they faced, how they worked together, what they learned about physics or problem-solving, and the importance of perseverance. Award fun titles like 'Most Creative Chain Reaction', 'Most Collaborative Team', 'Best Problem-Solving', or 'Most Unexpected Outcome'."
                ],
                materials: ["Cardboard Boxes (2)", "Popsicle Sticks (various)", "Rubber Bands (various)", "Skewers (various)", "Toothpicks (500)", "Plastic Cups (100)", "Plastic Balls (2 bags)", "Wooden Blocks (32)", "Cardboard (10)", "CDs (17)", "Yarn (various)", "Masking Tape (3 rolls)", "Scotch Tape (14 rolls)", "Packing Tape (15 rolls)", "Duct Tape (1 roll)", "Laundry Baskets (11)", "Balloons (3 bags)", "Small Plastic Critters (2 large ziplocks)", "Small Plastic Dinosaurs (30)", "Golf Balls (approx 100)", "Small Metal Cups (6)", "Scissors (various)", "Glue Sticks (various)", "White Glue Bottles (11)", "Stopwatch (1)", "Marbles (suggested purchase)", "Dominoes (suggested purchase)"],
                safety: "Supervise the use of sharp objects like skewers and scissors carefully. Ensure the building area is stable and clear to prevent items from falling or causing tripping hazards. Remind children not to throw materials or use them in an unsafe manner. Ensure any moving parts of the contraption are safe and won't pinch fingers or cause injury.",
                supercharged: "Building a contraption with many steps reminds us that God works in our lives in many ways, often through a series of events that lead to a bigger purpose. Even when things don't go as planned, we can learn and adjust, trusting that God is in control and has a master plan. How can you trust God's process even when you don't see the whole picture?",
                deleted: false
            },
            {
                id: 'game15',
                name: "Camp Mural Masterpiece",
                type: "Team Time",
                location: "Indoor",
                description: "Teams collaborate on a large-scale art project, creating a mural representing camp life, Foursquare values, or a chosen theme.",
                objectives: "Fosters creativity, collaborative art-making, communication, and imaginative expression.",
                generalInstructions: [
                    "<strong>Setup:</strong> Prepare a large surface for the mural. This could be a large white tarp laid on the floor, several large sheets of construction paper taped together on a wall or laid out, or a large roll of butcher paper. Provide a wide array of art supplies: washable markers, crayons, paints (tempera or washable acrylics), brushes, sponges, glue sticks, white glue, scissors, and various collage materials (e.g., construction paper scraps, yarn, plastic critters, laminated Bible verses for inspiration, magazine cutouts, glitter). Ensure adequate protection for the floor/tables if using paint.",
                    "<strong>Theme & Team Formation:</strong> Assign a clear theme for the mural (e.g., 'What Foursquare Camp Means to Me', 'Growing in Faith', 'Community in Action', 'The Fourfold Gospel'). Divide campers into teams (e.g., 4-6 campers per team). Each team can be assigned a specific section of the mural to work on, or a particular aspect of the theme to represent. Clearly mark team sections if applicable.",
                    "<strong>Brainstorm & Create (45-60 minutes):</strong> Teams brainstorm ideas for their section or contribution to the mural, considering how their part will connect with other teams' parts to form a cohesive whole. Campers then use the art supplies to draw, paint, and collage their section of the mural. Encourage them to be bold and expressive.",
                    "<strong>Collaboration:</strong> Encourage communication between teams, especially if they are working on adjacent sections, to ensure cohesion and a unified final piece. Leaders should circulate to offer guidance, support, and help with material distribution. Remind campers to share supplies and work together.",
                    "<strong>Presentation (5-10 minutes):</strong> Once the mural is complete (or time is up), gather the campers to view the entire masterpiece. Each team can briefly present their section, explaining what they depicted and why, and how it connects to the overall theme. Facilitate a discussion about the entire mural and what it represents.",
                    "<strong>Display:</strong> Find a prominent place to display the completed mural as a reminder of their collaborative efforts and the camp's themes. Take a photo for camp memories."
                ],
                materials: ["White Tarp (1)", "Construction Paper (various)", "Butcher Paper (suggested purchase)", "Washable Markers (various)", "Crayons (various)", "Sharpies (various)", "Black Paint (3 bottles)", "Pink Paint (2 bottles)", "Orange Paint (2 bottles)", "Blue Paint (1 bottle)", "Sponges (21½ bags)", "Glue Sticks (various)", "White Glue Bottles (11)", "Scissors (various)", "Plastic Critters (2 large ziplocks)", "Foam Beads (1 bag ziplocks)", "Yarn (various)", "CDs (17)", "Masking Tape (3 rolls)", "Laminated Bible Chapter Names (2 sets)", "Glitter (suggested purchase)", "Magazine cutouts (optional)"],
                safety: "Ensure adequate ventilation if using paints. Protect surfaces with drop cloths or newspaper. Supervise scissor and glue use carefully. Remind children not to put art supplies in their mouths. Have water and paper towels readily available for clean-up. Ensure walking paths around the mural are clear to prevent tripping over supplies.",
                supercharged: "Creating a mural together shows us how each of us is a unique part of God's beautiful masterpiece, the Church. When we combine our individual talents and efforts, we can create something much bigger and more beautiful than we could alone. How can you use your unique gifts to contribute to God's 'masterpiece'?",
                deleted: false
            },
            {
                id: 'game16',
                name: "Blindfolded Building Challenge",
                type: "Team Time",
                location: "Indoor",
                description: "Blindfolded team members build a structure (e.g., block tower, cup pattern) guided solely by verbal instructions from non-blindfolded teammates.",
                objectives: "Enhances precise communication, active listening, trust, and spatial reasoning.",
                generalInstructions: [
                    "<strong>Setup:</strong> Prepare a reference image or diagram of a simple structure (e.g., a specific block tower design, a pattern of stacked cups, a LEGO creation, a simple shape made of popsicle sticks). Ensure the structure is achievable with the provided materials and is not overly complex. Provide each team with an identical set of building materials (e.g., wooden blocks, plastic cups, LEGOs, popsicle sticks) and blindfolds or bandanas. Each team should have a designated building surface (e.g., a small table or clear floor space).",
                    "<strong>Team Formation:</strong> Divide campers into small teams (e.g., 3-5 players per team). For each round, designate one or two team members to be the 'builders' (who will be blindfolded) and the rest to be the 'guides' (who will give instructions). Rotate roles in subsequent rounds.",
                    "<strong>Game Play:</strong> The builders are blindfolded and sit at their building area with the materials within reach. The guides stand a short distance away, where they can clearly see the reference image but *cannot* touch the materials, the blindfolded builders, or the structure being built. The guides must use only verbal instructions to direct the builders to construct the replica of the reference image.",
                    "<strong>Communication Rules:</strong> Emphasize clear, concise, and specific instructions. Guides should describe shapes, colors, positions, and orientations precisely (e.g., 'Take the red square block', 'Place it on top of the green rectangle, centered', 'Rotate it 90 degrees clockwise'). Builders can ask clarifying questions (e.g., 'Do you mean the long side or the short side?'), but guides cannot use gestures or touch. If the structure falls or is built incorrectly, the team must correct it or restart that section.",
                    "<strong>Winning:</strong> The first team to successfully build the structure exactly as shown in the reference image wins the round. You can play multiple rounds, rotating who is blindfolded and introducing new reference images for each round.",
                    "<strong>Variations:</strong> Increase difficulty by using more complex structures, limiting communication to only 'yes' or 'no' answers, or adding a strict time limit (e.g., 5-10 minutes per round)."
                ],
                materials: ["Wooden Blocks (32)", "Plastic Cups (100)", "LEGOs (suggested purchase)", "Bandanas (approx. 70)", "Blindfolds (suggested purchase)", "Cardstock Paper (50)", "Popsicle Sticks (various)", "Stopwatch (1)", "Whistles (2)"],
                safety: "Ensure the building area is clear and safe to prevent tripping or bumping into objects. Remind children to be gentle with the materials and each other. Supervise closely to ensure blindfolded players are safe and not frustrated. Provide clear boundaries for the guides to prevent them from interfering physically. All building materials must be safe and non-toxic.",
                supercharged: "This challenge teaches us about the importance of clear communication and trust. Just as the blindfolded builder trusts their teammates, we can trust God's guidance for our lives, even when we can't see the path ahead. And like the guides, we are called to communicate God's truth clearly to others. How can you practice trusting God more and communicating His truth to those around you?",
                deleted: false
            },
            {
                id: 'game17',
                name: "Camp Storytelling Charades",
                type: "Team Time",
                location: "Indoor",
                description: "Teams act out camp-related or Foursquare-themed prompts (e.g., 'roasting marshmallows,' 'praying together'), fostering creative expression and non-verbal communication.",
                objectives: "Encourages creative expression, non-verbal communication, and quick thinking.",
                generalInstructions: [
                    "<strong>Setup:</strong> Prepare numerous slips of paper, each with a prompt written on it. Prompts should be camp-related activities (e.g., 'roasting marshmallows', 'swimming in the lake', 'singing campfire songs', 'packing a suitcase', 'going on a hike', 'telling ghost stories'), Foursquare values (e.g., 'praying together', 'healing the sick', 'sharing the Gospel', 'giving generously', 'reading the Bible'), or simple Bible concepts/stories (e.g., 'Noah's Ark', 'David and Goliath', 'Jesus walking on water'). Fold the slips and place them in a bucket or container. Designate a clear acting area for each team, visible to their teammates.",
                    "<strong>Team Formation:</strong> Divide campers into small teams (e.g., 4-6 players per team). Each team will take turns acting.",
                    "<strong>Game Play:</strong> The first player from Team A runs to the bucket, picks one slip of paper (no 'fishing' for easy ones!), and returns to their team. Standing in the designated acting area, the player acts out the prompt for their teammates. They cannot speak, make sounds, or mouth words – only gestures, facial expressions, and body language are allowed. Set a time limit for guessing (e.g., 60 seconds per prompt).",
                    "<strong>Guessing & Scoring:</strong> Teammates yell out their guesses. The moment the correct prompt is guessed, the team earns a point. If the team guesses correctly within the time limit, the actor then goes to the end of their team's line, and the next player in line for that team can immediately run to the bucket to get the next prompt. If they don't guess within the time limit, no points are awarded for that prompt, and the turn passes to the next team.",
                    "<strong>Alternating Turns:</strong> Teams alternate turns.",
                    "<strong>Winning:</strong> The game continues for a set time (e.g., 20-30 minutes) or until all prompts have been used. The team with the most points at the end wins. Encourage good sportsmanship and cheering for all participants."
                ],
                materials: ["Paper (various)", "Pencils (various)", "Pens (3)", "Washable Markers (various)", "Buckets (various)", "Red Basket (1)", "Scoreboard (1)", "Whistles (2)", "Stopwatch (1)"],
                safety: "Ensure ample space for acting to prevent collisions or falls. Remind children to be mindful of their surroundings and not to get too wild with their movements. Emphasize respectful guessing and sportsmanship. No physical contact between actors and guessers.",
                supercharged: "Charades reminds us that we can communicate powerful messages in many ways, not just with words. God speaks to us through His creation, through His Spirit, and through the actions of others. How can you 'act out' God's love to someone this week without saying a word?",
                deleted: false
            },
            {
                id: 'game18',
                name: "Foursquare Camp Trivia Challenge",
                type: "Team Time",
                location: "Indoor",
                description: "Teams answer trivia questions on camp knowledge, Foursquare history/values, and 'guess the sound' challenges, testing knowledge and quick thinking.",
                objectives: "Enhances knowledge recall, quick thinking, teamwork, and active listening.",
                generalInstructions: [
                    "<strong>Setup:</strong> Prepare a list of trivia questions across various categories: <br> - <strong>Camp Facts:</strong> (e.g., 'What is the name of our camp director?', 'How many meals do we eat in a day?', 'What is the camp theme song?'). <br> - <strong>Foursquare History/Values:</strong> (e.g., 'What are the four symbols of the Foursquare Gospel?', 'Who founded the Foursquare Church?', 'What does 'Foursquare' mean?'). <br> - <strong>Simple Bible Stories/Characters:</strong> (e.g., 'Who built the ark?', 'Who was swallowed by a big fish?', 'What was the first miracle Jesus performed?'). <br> - <strong>'Guess the Sound':</strong> (play pre-recorded camp-related sounds like a whistle, a tent zipper, a campfire crackling, a specific animal sound, or a song snippet). <br> Divide campers into small teams (e.g., 4-6 players per team). Designate a 'buzzer' system for each team (e.g., a small metal cup to tap, a bell, or simply raising a hand). Have a scorekeeper ready with a scoreboard.",
                    "<strong>Game Play:</strong> The leader reads a question aloud. The first team to 'buzz in' (or raise their hand/tap their buzzer) gets the chance to answer. Set a time limit for answering (e.g., 10-15 seconds). If they answer correctly, they earn points (e.g., 1 point per question). If they answer incorrectly, the other teams get a chance to 'steal' by buzzing in. If no team answers correctly, the leader reveals the answer and moves to the next question.",
                    "<strong>Scoring:</strong> Keep score on a whiteboard or large paper. You can assign different point values for different categories or difficulty levels (e.g., 1 point for easy, 2 for medium, 3 for hard).",
                    "<strong>Winning:</strong> The game continues for a set number of rounds (e.g., 10-15 questions) or a predetermined time limit (e.g., 30 minutes). The team with the most points at the end wins. Encourage good sportsmanship and cheering for all participants, regardless of score."
                ],
                materials: ["Paper (various)", "Pencils (various)", "Pens (3)", "Washable Markers (various)", "Scoreboard (1)", "Small Metal Cups (6)", "Flash Cards (60)", "Whistles (2)", "Stopwatch (1)", "Sound device (e.g., phone/speaker for 'guess the sound' if applicable)", "Pre-recorded sounds (if using 'Guess the Sound')"],
                safety: "Ensure the area is clear and organized. Remind children to be respectful when others are answering and to wait for their turn to buzz in. No pushing or shoving to get to the buzzer. Ensure the volume for sound clips is appropriate and not too loud.",
                supercharged: "Trivia challenges our knowledge, just as studying the Bible helps us grow in our understanding of God and His truth. The more we learn about Him, the better equipped we are to live for Him. What new things did you learn about God or the Foursquare Church today?",
                deleted: false
            },
            {
                id: 'game19',
                name: "Catapult Challenge",
                type: "Team Time",
                location: "Indoor",
                description: "Teams design and build their own small catapults using provided materials, then compete in challenges like launching projectiles for distance or accuracy.",
                objectives: "Fosters engineering design, problem-solving, precision, and friendly competition.",
                generalInstructions: [
                    "<strong>Setup:</strong> Designate a building area for each team. Provide each team with a kit of materials for building a small catapult. Common materials include: popsicle sticks, rubber bands (various thicknesses), plastic spoons (as the launching arm), plastic cups (as projectile holders), glue sticks, white glue, and scissors. Also, provide various soft, safe projectiles (e.g., cotton balls, small plastic balls, crumpled paper, small clay balls). Prepare a clear launching zone and target areas for the competition phase.",
                    "<strong>Team Formation:</strong> Divide campers into small teams (e.g., 3-5 players per team). Present the challenge: to design and build a functional catapult that can launch a projectile.",
                    "<strong>Build Time (30-40 minutes):</strong> Teams have this time to brainstorm, design, and construct their catapult. Encourage them to experiment with different designs and test their catapults during the building phase. Leaders should circulate to offer guidance and ensure safe construction.",
                    "<strong>Competition Challenges:</strong> Once the building time is up, teams will bring their catapults to a designated competition area and compete in one or more challenges: <br> - <strong>Distance Challenge:</strong> Each team launches a projectile from a designated line, aiming for the furthest distance. Mark the landing spots and measure the distance. Each team gets 3-5 attempts. <br> - <strong>Accuracy Challenge:</strong> Set up targets (e.g., buckets, hula hoops, marked circles on the floor) at various distances. Teams try to land projectiles inside the targets for points. Assign different point values for different targets/distances. Each team gets 3-5 attempts. <br> - <strong>Volume Challenge:</strong> Teams try to launch as many projectiles as possible into a container within a set time (e.g., 60 seconds).",
                    "<strong>Scoring:</strong> Points are awarded based on performance in the chosen challenges (e.g., furthest distance in feet/meters, most accurate shots, most projectiles in the bucket). Keep a clear score for each team on a scoreboard.",
                    "<strong>Winning:</strong> The team with the highest total score across all challenges wins. Celebrate all efforts, regardless of score."
                ],
                materials: ["Popsicle Sticks (various)", "Rubber Bands (various)", "Plastic Spoons (36)", "Plastic Cups (100)", "Small Plastic Balls (2 bags)", "Cotton Balls (suggested purchase)", "Paper Clips (suggested purchase)", "Clay (suggested purchase)", "Glue Sticks (various)", "White Glue Bottles (11)", "Scissors (various)", "Stopwatch (1)", "Measuring Tape (suggested purchase)", "Cones (for marking lines/targets)", "Buckets (various)", "Hula Hoops (25)"],
                safety: "Emphasize aiming only at designated targets, never at people. Projectiles should always be soft and harmless. Supervise the building process carefully, especially when using scissors or glue. Ensure the launching area is clear and that no one is standing in the path of projectiles. Remind children not to 'overload' or misuse the catapults in a dangerous way.",
                supercharged: "Building and launching catapults teaches us about design, precision, and cause-and-effect. In our faith, we are called to be intentional in our actions, knowing that our efforts, when guided by God, can have a far-reaching impact. What 'impact' do you want to make for God's kingdom, and what steps can you take to 'launch' into that purpose?",
                deleted: false
            },
            {
                id: 'game20',
                name: "Giant Checkers Tournament",
                type: "Team Time",
                location: "Indoor",
                description: "Teams strategize and play a large-scale game of checkers, with campers moving as the pieces, fostering logical thinking and collaborative strategy.",
                objectives: "Enhances strategic thinking, logical reasoning, teamwork, and communication.",
                generalInstructions: [
                    "<strong>Setup:</strong> Set up the giant checkers board in a clear, open indoor area (e.g., gym floor, large hall). Ensure there is enough space around the board for players to move. If using campers as pieces, ensure they understand their role and boundaries. Each team will need a designated 'holding area' for their captured pieces.",
                    "<strong>Team Formation:</strong> Divide campers into two teams. Each team will be one color of checkers (e.g., Red Team, Black Team). Assign 6-8 players from each team to be the 'checkers' (they will physically move on the board when instructed by their team). The remaining players will be the 'strategists' who help decide moves from the sidelines. Rotate roles between games.",
                    "<strong>Checkers Rules:</strong> <br> - Pieces move diagonally forward one square at a time. <br> - To capture an opponent's piece, a player must jump over it diagonally to an empty square immediately beyond. The captured piece is removed from the board and goes to the capturing team's 'holding area'. <br> - If a player reaches the opponent's back row, their piece is 'crowned' (e.g., another piece is placed on top of it, or they wear a special hat/sash), and it can then move both forward and backward diagonally. <br> - Players *must* take a jump if one is available. If multiple jumps are available, they can choose which one to take. <br> - No jumping over your own pieces. <br> - Pieces cannot move backward unless crowned.",
                    "<strong>Winning:</strong> The game ends when one team has captured all of the opponent's pieces, or when the opponent has no legal moves left. The team that successfully eliminates or blocks the other team wins the round. Play multiple rounds for a tournament format, ensuring all teams get a chance to play."
                ],
                materials: ["Giant Checkers Game (at Parkside - assume available)", "Cones (various)", "Whistles (2)", "Stopwatch (1)", "Small hats/sashes (for 'crowned' pieces - suggested purchase)"],
                safety: "Ensure players move carefully on the board, especially when jumping over other players (if campers are pieces). Remind children not to run, push, or shove. Supervise closely to ensure fair play and prevent any accidental falls. Ensure the board surface is non-slip. Clearly communicate rules regarding physical contact and safe movement.",
                supercharged: "Playing giant checkers teaches us about strategy and foresight. In our faith, we are called to be wise and thoughtful, making choices that align with God's plan. Sometimes we need to sacrifice something small for a bigger victory, just like moving a checker piece. How can you be more strategic in your walk with God?",
                deleted: false
            }
        ];

        // This variable will hold all activities, including initial and user-added ones.
        let allActivities = [];
        let activityTypeChart; // Declare chart variable globally
        let activityToDeleteId = null; // To store the ID of the activity to be permanently deleted

        document.addEventListener('DOMContentLoaded', async () => {
            const gameGrid = document.getElementById('game-grid');
            const modal = document.getElementById('game-modal');
            const modalTitle = document.getElementById('modal-title');
            const modalContent = document.getElementById('modal-content');
            const closeModalBtn = document.getElementById('close-modal');
            const typeFilters = document.getElementById('type-filters');
            const locationFilters = document.getElementById('location-filters');
            const materialFilterSelect = document.getElementById('material-filter-select');
            const addActivityModal = document.getElementById('add-activity-modal');
            const closeAddActivityModalBtn = document.getElementById('close-add-activity-modal');
            const addActivityForm = document.getElementById('add-activity-form');
            const instructionsContainer = document.getElementById('instructions-container');
            const addInstructionBtn = document.getElementById('add-instruction-btn');
            const materialsContainer = document.getElementById('materials-container');
            const addMaterialBtn = document.getElementById('add-material-btn');
            const loadingIndicator = document.getElementById('loading-indicator');
            const userIdDisplay = document.getElementById('user-id-display');
            const moveToTrashBtn = document.getElementById('move-to-trash-btn');
            const viewDeletedActivitiesBtn = document.getElementById('view-deleted-activities-btn');
            const deletedActivitiesModal = document.getElementById('deleted-activities-modal');
            const closeDeletedActivitiesModalBtn = document.getElementById('close-deleted-activities-modal');
            const deletedActivitiesList = document.getElementById('deleted-activities-list');
            const deletedCountSpan = document.getElementById('deleted-count');
            const confirmationModal = document.getElementById('confirmation-modal');
            const confirmPermanentDeleteBtn = document.getElementById('confirm-permanent-delete-btn');
            const cancelPermanentDeleteBtn = document.getElementById('cancel-permanent-delete-btn');
            const leaderResourcesToggle = document.getElementById('leader-resources-toggle');
            const leaderResourcesContent = document.getElementById('leader-resources-content');
            const collapseIcon = leaderResourcesToggle.querySelector('.collapse-icon');


            let currentFilters = { type: 'all', location: 'all', material: 'all' };

            // Initialize Firebase
            try {
                app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);
                console.log("Firebase Auth initialized:", auth); // Log auth object for debugging

                // Authenticate user
                onAuthStateChanged(auth, async (user) => {
                    if (user) {
                        userId = user.uid;
                    } else {
                        let signedIn = false;
                        // Use __initial_auth_token if available (from Canvas environment)
                        if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                            try {
                                console.log("Attempting signInWithCustomToken...");
                                await signInWithCustomToken(auth, __initial_auth_token);
                                userId = auth.currentUser.uid;
                                signedIn = true;
                                console.log("Signed in with custom token.");
                            } catch (error) {
                                if (error.code === 'auth/custom-token-mismatch') {
                                    console.warn("Firebase custom token mismatch, attempting anonymous sign-in.");
                                } else {
                                    console.error("Firebase custom token authentication failed unexpectedly:", error);
                                }
                                // signedIn remains false, so it will proceed to anonymous sign-in
                            }
                        }

                        if (!signedIn) { // This condition will be true if custom token failed or was not present
                            try {
                                console.log("Attempting signInAnonymously...");
                                await signInAnonymously(auth);
                                userId = auth.currentUser.uid;
                                signedIn = true;
                                console.log("Signed in anonymously.");
                            } catch (anonError) {
                                console.error("Firebase anonymous authentication failed, falling back to random UUID:", anonError);
                                userId = crypto.randomUUID();
                            }
                        }
                    }
                    userIdDisplay.textContent = `User ID: ${userId}`;
                    console.log("Firebase initialized. User ID:", userId);
                    // Start listening for activities only after auth is ready
                    listenForActivities();
                });

            } catch (error) {
                console.error("Error initializing Firebase:", error);
                loadingIndicator.textContent = "Error loading activities. Please ensure Firebase config is correct and security rules are set up.";
                // Fallback to a random UUID if Firebase init fails
                userId = crypto.randomUUID();
                userIdDisplay.textContent = `User ID: ${userId} (Offline Mode)`;
                // If Firebase fails to initialize, we can still show initial games
                allActivities = [...initialGamesData];
                renderGames();
                populateMaterialFilter();
                updateActivityChart();
                updateDeletedCount();
            }

            // Function to listen for real-time activity updates from Firestore
            function listenForActivities() {
                if (!db || !userId) {
                    console.warn("Firestore or User ID not ready for listening.");
                    // If Firestore isn't ready, just display the initial games.
                    allActivities = [...initialGamesData];
                    renderGames();
                    populateMaterialFilter();
                    updateActivityChart();
                    updateDeletedCount();
                    return;
                }
                // Firestore Security Rule Reminder:
                // Ensure your Firestore security rules allow read/write access to `artifacts/{appId}/users/{userId}/activities`
                // for authenticated users, where `userId` matches `request.auth.uid`.
                // Example rule:
                // match /databases/{database}/documents {
                //   match /artifacts/{appId}/users/{userId}/{documents=**} {
                //     allow read, write: if request.auth != null && request.auth.uid == userId;
                //   }
                // }
                const activitiesCollectionRef = collection(db, `artifacts/${appId}/users/${userId}/activities`);
                const q = query(activitiesCollectionRef);

                onSnapshot(q, (snapshot) => {
                    loadingIndicator.style.display = 'none'; // Hide loading indicator once data starts coming
                    const fetchedGames = [];
                    snapshot.forEach(doc => {
                        fetchedGames.push({ id: doc.id, ...doc.data() });
                    });
                    // Merge initial games with fetched games, prioritizing fetched games by ID if duplicates exist
                    const mergedGamesMap = new Map();
                    initialGamesData.forEach(game => mergedGamesMap.set(game.id, game));
                    fetchedGames.forEach(game => mergedGamesMap.set(game.id, game));
                    
                    allActivities = Array.from(mergedGamesMap.values());
                    renderGames();
                    populateMaterialFilter();
                    updateActivityChart();
                    updateDeletedCount();
                    console.log("Activities updated from Firestore (merged with initial data):", allActivities);
                    console.log(`Total activities currently displayed: ${allActivities.length}`);
                }, (error) => {
                    console.error("Error fetching activities from Firestore:", error);
                    loadingIndicator.textContent = "Failed to load user activities. Displaying initial games. Please check console for Firebase errors (often security rules related).";
                    // Fallback to initial games if Firestore fetch fails
                    allActivities = [...initialGamesData];
                    renderGames();
                    populateMaterialFilter();
                    updateActivityChart();
                    updateDeletedCount();
                });
            }

            function getUniqueMaterials() {
                const allMaterials = new Set();
                allActivities.forEach(game => {
                    if (game.materials && Array.isArray(game.materials)) {
                        game.materials.forEach(material => {
                            const normalizedMaterial = material.split('(')[0].trim();
                            if (normalizedMaterial) { // Ensure material is not empty
                                allMaterials.add(normalizedMaterial);
                            }
                        });
                    }
                });
                return Array.from(allMaterials).sort();
            }

            function populateMaterialFilter() {
                const uniqueMaterials = getUniqueMaterials();
                materialFilterSelect.innerHTML = '<option value="all">All Materials</option>';
                uniqueMaterials.forEach(material => {
                    const option = document.createElement('option');
                    option.value = material;
                    option.textContent = material;
                    materialFilterSelect.appendChild(option);
                });
            }

            function renderGames() {
                gameGrid.innerHTML = '';
                
                const filteredGames = allActivities.filter(game => {
                    // Only show activities that are NOT deleted and match filters
                    const notDeleted = !game.deleted;
                    const typeMatch = currentFilters.type === 'all' || game.type === currentFilters.type;
                    const locationMatch = currentFilters.location === 'all' || game.location === currentFilters.location || game.location === 'Both';
                    
                    let materialMatch = true;
                    if (currentFilters.material !== 'all') {
                        materialMatch = game.materials && Array.isArray(game.materials) && game.materials.some(material => 
                            material.split('(')[0].trim() === currentFilters.material
                        );
                    }
                    
                    return notDeleted && typeMatch && locationMatch && materialMatch;
                });

                filteredGames.forEach((game) => {
                    const card = document.createElement('div');
                    card.className = 'bg-white rounded-xl shadow-sm border border-stone-200 p-6 cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-all duration-300 flex flex-col';
                    card.dataset.gameId = game.id;
                    
                    const typeColor = game.type === 'Field Game' ? 'bg-sky-100 text-sky-800' : 'bg-amber-100 text-amber-800';
                    const locationIcon = game.location === 'Outdoor' ? '☀️' : game.location === 'Indoor' ? '🏠' : '☀️/🏠';

                    card.innerHTML = `
                        <div class="flex-grow">
                            <div class="flex justify-between items-start mb-3">
                                <span class="text-xs font-bold py-1 px-3 rounded-full ${typeColor}">${game.type || 'N/A'}</span>
                                <span class="text-xl">${locationIcon}</span>
                            </div>
                            <h3 class="text-xl font-bold text-teal-700 mb-2">${game.name || 'Untitled Activity'}</h3>
                            <p class="text-stone-600 text-sm">${game.description || (game.objectives ? game.objectives.substring(0, 100) + '...' : 'No description available.')}</p>
                        </div>
                        <button class="mt-4 w-full bg-teal-600 text-white font-semibold py-2 px-4 rounded-lg hover:bg-teal-700 transition-colors view-details-btn">View Details</button>
                    `;
                    gameGrid.appendChild(card);
                    
                    requestAnimationFrame(() => {
                        card.classList.add('card-enter');
                        requestAnimationFrame(() => {
                            card.classList.add('card-enter-active');
                        });
                    });
                });

                // Add the "Add New Activity" card at the end
                const addActivityCard = document.createElement('div');
                addActivityCard.className = 'bg-emerald-100 rounded-xl shadow-sm border border-emerald-300 p-6 cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-all duration-300 flex flex-col items-center justify-center text-center h-48'; // Fixed height for consistency
                addActivityCard.id = 'add-activity-card';
                addActivityCard.innerHTML = `
                    <div class="text-emerald-700 text-6xl mb-4">+</div>
                    <h3 class="text-xl font-bold text-emerald-700">Add New Activity</h3>
                    <p class="text-emerald-600 text-sm mt-2">Create a custom activity for your camp!</p>
                `;
                gameGrid.appendChild(addActivityCard);
            }

            function showGameDetails(gameId) {
                const game = allActivities.find(g => g.id == gameId);
                if (!game) return;

                modalTitle.textContent = game.name || 'Activity Details';
                
                let materialsHTML = game.materials && Array.isArray(game.materials) && game.materials.length > 0 ? game.materials.map(item => `<li class="bg-stone-100 py-1 px-3 rounded-md">${item}</li>`).join('') : '<p class="text-stone-700">No specific materials listed.</p>';
                
                let instructionsContent = '';

                // Prioritize generalInstructions, then fallback to instructions
                const instructionsToRender = game.generalInstructions && Array.isArray(game.generalInstructions) && game.generalInstructions.length > 0
                    ? game.generalInstructions
                    : (game.instructions && Array.isArray(game.instructions) && game.instructions.length > 0 ? game.instructions : []);

                if (instructionsToRender.length > 0) {
                    instructionsContent += `
                        <div>
                            <h4 class="text-lg font-bold text-teal-700 mb-2">⚙️ Instructions</h4>
                            <ol class="list-decimal list-inside space-y-2 text-stone-700">
                                ${instructionsToRender.map(step => `<li>${step}</li>`).join('')}
                            </ol>
                        </div>
                    `;
                } else {
                    instructionsContent += `<div><h4 class="text-lg font-bold text-teal-700 mb-2">⚙️ Instructions</h4><p class="text-stone-700">No instructions available.</p></div>`;
                }

                // Render station-specific instructions if available (assuming this might be in some future data)
                if (game.stationInstructions && Array.isArray(game.stationInstructions) && game.stationInstructions.length > 0) {
                    instructionsContent += `
                        <div class="mt-6">
                            <h4 class="text-lg font-bold text-teal-700 mb-2">Stations Breakdown</h4>
                            <div class="space-y-4">
                                ${game.stationInstructions.map(station => `
                                    <div class="bg-stone-50 p-4 rounded-lg border border-stone-200">
                                        <h5 class="text-md font-semibold text-teal-600 mb-2">${station.title || 'Untitled Station'}</h5>
                                        ${station.content || '<p class="text-stone-700">No content for this station.</p>'}
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }

                modalContent.innerHTML = `
                    <div class="space-y-6">
                        <div>
                            <h4 class="text-lg font-bold text-teal-700 mb-2">🎯 Objectives</h4>
                            <p class="text-stone-700">${game.objectives || 'No objectives listed.'}</p>
                        </div>
                        ${instructionsContent}
                         <div>
                            <h4 class="text-lg font-bold text-teal-700 mb-2">📦 Materials Needed</h4>
                            <ul class="flex flex-wrap gap-2 text-sm text-stone-800">
                                ${materialsHTML}
                            </ul>
                        </div>
                        <div>
                            <h4 class="text-lg font-bold text-teal-700 mb-2">⚠️ Safety Notes</h4>
                            <p class="text-stone-700">${game.safety || 'No safety notes listed.'}</p>
                        </div>
                        <div>
                            <h4 class="text-lg font-bold text-teal-700 mb-2">⚡ SuperCharged Application</h4>
                            <p class="text-stone-700 italic">${game.supercharged || 'No SuperCharged application listed.'}</p>
                        </div>
                    </div>
                `;
                moveToTrashBtn.dataset.gameId = gameId; // Set the game ID on the trash button
                modal.classList.add('active');
            }

            // Event listener for the game grid, including the new "Add Activity" card
            gameGrid.addEventListener('click', (e) => {
                const addCard = e.target.closest('#add-activity-card');
                if (addCard) {
                    addActivityModal.classList.add('active');
                    addActivityForm.reset(); // Clear form on open
                    // Ensure at least one instruction and material field is present
                    instructionsContainer.innerHTML = `
                        <div class="instruction-item flex items-center gap-2">
                            <textarea name="instructions[]" rows="2" required class="w-full p-3 border border-stone-300 rounded-md focus:ring-teal-500 focus:border-teal-500" placeholder="e.g., Setup: Divide a large outdoor field..."></textarea>
                            <button type="button" class="remove-instruction-btn text-red-500 hover:text-red-700 text-xl font-bold">&times;</button>
                        </div>
                    `;
                    materialsContainer.innerHTML = `
                        <div class="material-item flex items-center gap-2">
                            <input type="text" name="materials[]" class="w-full p-3 border border-stone-300 rounded-md focus:ring-teal-500 focus:border-teal-500" placeholder="e.g., Water Guns (14)">
                            <button type="button" class="remove-material-btn text-red-500 hover:text-red-700 text-xl font-bold">&times;</button>
                        </div>
                    `;
                    addRemoveEventListeners(); // Re-add listeners for new fields
                } else {
                    const card = e.target.closest('.view-details-btn'); // Target the "View Details" button specifically
                    if (card) {
                        showGameDetails(card.closest('[data-game-id]').dataset.gameId);
                    }
                }
            });

            closeModalBtn.addEventListener('click', () => modal.classList.remove('active'));
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.classList.remove('active');
                }
            });

            function handleFilterClick(e, filterType) {
                 if (e.target.tagName !== 'BUTTON') return;

                const value = e.target.dataset[filterType];
                currentFilters[filterType] = value;

                const filterGroup = e.target.parentElement;
                filterGroup.querySelectorAll('button').forEach(btn => {
                    btn.classList.remove('bg-teal-600', 'text-white');
                    btn.classList.add('bg-stone-200', 'text-stone-700');
                });
                e.target.classList.add('bg-teal-600', 'text-white');
                e.target.classList.remove('bg-stone-200', 'text-stone-700');
                
                renderGames();
            }

            typeFilters.addEventListener('click', (e) => handleFilterClick(e, 'type'));
            locationFilters.addEventListener('click', (e) => handleFilterClick(e, 'location'));
            
            materialFilterSelect.addEventListener('change', (e) => {
                currentFilters.material = e.target.value;
                renderGames();
            });

            function updateActivityChart() {
                // Only count non-deleted activities for the chart
                const activeActivities = allActivities.filter(g => !g.deleted);
                const fieldGameCount = activeActivities.filter(g => g.type === 'Field Game').length;
                const teamTimeCount = activeActivities.filter(g => g.type === 'Team Time').length;

                if (activityTypeChart) {
                    activityTypeChart.data.datasets[0].data = [fieldGameCount, teamTimeCount];
                    activityTypeChart.update();
                } else {
                    const ctx = document.getElementById('activityTypeChart').getContext('2d');
                    activityTypeChart = new Chart(ctx, {
                        type: 'doughnut',
                        data: {
                            labels: ['Field Games', 'Team Time'],
                            datasets: [{
                                label: 'Activity Types',
                                data: [fieldGameCount, teamTimeCount],
                                backgroundColor: [
                                    'rgb(14 116 144)', // teal-700
                                    'rgb(217 119 6)'   // amber-600
                                ],
                                borderColor: [
                                    '#ffffff',
                                    '#ffffff'
                                ],
                                borderWidth: 4
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        font: {
                                            family: 'Inter',
                                            size: 14,
                                        },
                                        color: '#44403c' // stone-700
                                    }
                                }
                            },
                            cutout: '60%'
                        }
                    });
                }
            }
            
            // --- Add Activity Modal Logic ---
            closeAddActivityModalBtn.addEventListener('click', () => addActivityModal.classList.remove('active'));
            addActivityModal.addEventListener('click', (e) => {
                if (e.target === addActivityModal) {
                    addActivityModal.classList.remove('active');
                }
            });

            function addInstructionField() {
                const div = document.createElement('div');
                div.className = 'instruction-item flex items-center gap-2';
                div.innerHTML = `
                    <textarea name="instructions[]" rows="2" required class="w-full p-3 border border-stone-300 rounded-md focus:ring-teal-500 focus:border-teal-500" placeholder="e.g., Setup: Divide a large outdoor field..."></textarea>
                    <button type="button" class="remove-instruction-btn text-red-500 hover:text-red-700 text-xl font-bold">&times;</button>
                `;
                instructionsContainer.appendChild(div);
                addRemoveEventListeners(); // Re-add listeners after adding new elements
            }

            function addMaterialField() {
                const div = document.createElement('div');
                div.className = 'material-item flex items-center gap-2';
                div.innerHTML = `
                    <input type="text" name="materials[]" class="w-full p-3 border border-stone-300 rounded-md focus:ring-teal-500 focus:border-teal-500" placeholder="e.g., Water Guns (14)">
                    <button type="button" class="remove-material-btn text-red-500 hover:text-red-700 text-xl font-bold">&times;</button>
                `;
                materialsContainer.appendChild(div);
                addRemoveEventListeners(); // Re-add listeners after adding new elements
            }

            function addRemoveEventListeners() {
                document.querySelectorAll('.remove-instruction-btn').forEach(button => {
                    button.onclick = (e) => {
                        if (instructionsContainer.children.length > 1) { // Ensure at least one field remains
                            e.target.closest('.instruction-item').remove();
                        }
                    };
                });
                document.querySelectorAll('.remove-material-btn').forEach(button => {
                    button.onclick = (e) => {
                        if (materialsContainer.children.length > 1) { // Ensure at least one field remains
                            e.target.closest('.material-item').remove();
                        }
                    };
                });
            }

            addInstructionBtn.addEventListener('click', addInstructionField);
            addMaterialBtn.addEventListener('click', addMaterialField);
            addRemoveEventListeners(); // Initial call for existing fields

            addActivityForm.addEventListener('submit', async (e) => {
                e.preventDefault();

                const formData = new FormData(e.target);
                const newActivity = {
                    name: formData.get('name'),
                    type: formData.get('type'),
                    location: formData.get('location'),
                    objectives: formData.get('objectives'),
                    safety: formData.get('safety'),
                    supercharged: formData.get('supercharged'),
                    // Get all instruction and material values
                    instructions: Array.from(document.querySelectorAll('#instructions-container textarea[name="instructions[]"]')).map(el => el.value).filter(val => val.trim() !== ''),
                    materials: Array.from(document.querySelectorAll('#materials-container input[name="materials[]"]')).map(el => el.value).filter(val => val.trim() !== ''),
                    description: formData.get('objectives').substring(0, 100) + '...', // Use objectives as description snippet
                    deleted: false // New activities are not deleted by default
                };

                // Basic validation
                if (!newActivity.name || !newActivity.type || !newActivity.location || !newActivity.objectives || !newActivity.safety || !newActivity.supercharged || newActivity.instructions.length === 0) {
                    console.error("Please fill in all required fields (marked with *).");
                    // In a real app, you'd show a user-friendly message here.
                    return;
                }

                try {
                    if (db && userId) {
                        const docRef = await addDoc(collection(db, `artifacts/${appId}/users/${userId}/activities`), newActivity);
                        console.log("Document written with ID: ", docRef.id);
                        addActivityModal.classList.remove('active');
                        addActivityForm.reset();
                        // The onSnapshot listener will automatically update the UI
                    } else {
                        console.error("Firestore not initialized or user not authenticated. Activity not saved.");
                        // Optionally, add the activity to the local array if Firestore is not available
                        // This would mean it won't persist, but will appear for the current session.
                        // For this request, we prioritize persistence, so we won't add to local array if save fails.
                    }
                } catch (error) {
                    console.error("Error adding document to Firestore: ", error);
                    // In a real app, you'd show an error message to the user
                }
            });

            // --- Soft Delete / Trash Can Logic ---
            moveToTrashBtn.addEventListener('click', async (e) => {
                const gameId = e.target.dataset.gameId;
                if (gameId && db && userId) {
                    try {
                        const activityRef = doc(db, `artifacts/${appId}/users/${userId}/activities`, gameId);
                        await updateDoc(activityRef, { deleted: true });
                        console.log(`Activity ${gameId} moved to trash.`);
                        modal.classList.remove('active'); // Close the details modal
                        // UI will update automatically via onSnapshot
                    } catch (error) {
                        console.error("Error moving activity to trash:", error);
                        // Show user-friendly error message
                    }
                }
            });

            viewDeletedActivitiesBtn.addEventListener('click', () => {
                renderDeletedActivities();
                deletedActivitiesModal.classList.add('active');
            });

            closeDeletedActivitiesModalBtn.addEventListener('click', () => deletedActivitiesModal.classList.remove('active'));
            deletedActivitiesModal.addEventListener('click', (e) => {
                if (e.target === deletedActivitiesModal) {
                    deletedActivitiesModal.classList.remove('active');
                }
            });

            function updateDeletedCount() {
                const deletedActivities = allActivities.filter(game => game.deleted);
                deletedCountSpan.textContent = deletedActivities.length;
            }

            function renderDeletedActivities() {
                deletedActivitiesList.innerHTML = '';
                const deletedGames = allActivities.filter(game => game.deleted);

                if (deletedGames.length === 0) {
                    deletedActivitiesList.innerHTML = '<p class="text-stone-600 text-center py-8">No activities in trash.</p>';
                    return;
                }

                deletedGames.forEach(game => {
                    const listItem = document.createElement('div');
                    listItem.className = 'bg-stone-100 p-4 rounded-lg flex flex-col sm:flex-row justify-between items-start sm:items-center border border-stone-200';
                    listItem.innerHTML = `
                        <div class="mb-2 sm:mb-0">
                            <h4 class="text-lg font-semibold text-stone-800">${game.name}</h4>
                            <p class="text-sm text-stone-600">${game.type} - ${game.location}</p>
                        </div>
                        <div class="flex flex-col sm:flex-row gap-2">
                            <button class="restore-activity-btn bg-teal-500 text-white font-semibold py-1 px-3 rounded-md hover:bg-teal-600 transition-colors text-sm" data-id="${game.id}">Restore</button>
                            <button class="permanent-delete-btn bg-red-500 text-white font-semibold py-1 px-3 rounded-md hover:bg-red-600 transition-colors text-sm" data-id="${game.id}">Delete Permanently</button>
                        </div>
                    `;
                    deletedActivitiesList.appendChild(listItem);
                });

                // Add event listeners for restore and permanent delete buttons
                deletedActivitiesList.querySelectorAll('.restore-activity-btn').forEach(button => {
                    button.addEventListener('click', (e) => restoreActivity(e.target.dataset.id));
                });
                deletedActivitiesList.querySelectorAll('.permanent-delete-btn').forEach(button => {
                    button.addEventListener('click', (e) => showConfirmationModal(e.target.dataset.id));
                });
            }

            async function restoreActivity(gameId) {
                if (db && userId) {
                    try {
                        const activityRef = doc(db, `artifacts/${appId}/users/${userId}/activities`, gameId);
                        await updateDoc(activityRef, { deleted: false });
                        console.log(`Activity ${gameId} restored.`);
                        deletedActivitiesModal.classList.remove('active'); // Close trash modal after restore
                        // UI will update automatically via onSnapshot
                    } catch (error) {
                        console.error("Error restoring activity:", error);
                        // Show user-friendly error message
                    }
                }
            }

            function showConfirmationModal(gameId) {
                console.log("Showing confirmation modal for gameId:", gameId); // DEBUG LOG
                activityToDeleteId = gameId; // Store the ID globally
                confirmationModal.classList.add('active');
            }

            confirmPermanentDeleteBtn.addEventListener('click', async () => {
                console.log("Permanent delete button clicked."); // DEBUG LOG
                console.log("Values before deletion check:", { activityToDeleteId, dbReady: !!db, userId }); // DEBUG LOG

                if (activityToDeleteId && db && userId) {
                    try {
                        await deleteDoc(doc(db, `artifacts/${appId}/users/${userId}/activities`, activityToDeleteId));
                        console.log(`Activity ${activityToDeleteId} permanently deleted.`);
                        confirmationModal.classList.remove('active');
                        deletedActivitiesModal.classList.remove('active'); // Close trash modal
                        activityToDeleteId = null; // Clear the stored ID
                        // UI will update automatically via onSnapshot
                    } catch (error) {
                        console.error("Error permanently deleting activity:", error);
                        // Show user-friendly error message
                    }
                } else {
                    console.warn("Permanent delete aborted: Missing activityToDeleteId, db, or userId."); // DEBUG LOG
                }
            });

            cancelPermanentDeleteBtn.addEventListener('click', () => {
                confirmationModal.classList.remove('active');
                activityToDeleteId = null; // Clear the stored ID
            });
            confirmationModal.addEventListener('click', (e) => {
                if (e.target === confirmationModal) {
                    confirmationModal.classList.remove('active');
                    activityToDeleteId = null;
                }
            });

            // --- Leader Resources Collapsible Logic ---
            leaderResourcesToggle.addEventListener('click', () => {
                leaderResourcesContent.classList.toggle('collapsed');
                collapseIcon.classList.toggle('collapsed');
            });
            
            // Initial render and chart update (will be updated by onSnapshot once data loads)
            // If Firebase fails to initialize, these will use initialGamesData
            // Otherwise, onSnapshot will trigger the first render after fetching user data.
            // This check ensures we don't try to render if Firebase is still initializing successfully.
            if (!app) { 
                renderGames();
                populateMaterialFilter();
                updateActivityChart();
                updateDeletedCount();
            }
        });
    </script>
</body>
</html>
